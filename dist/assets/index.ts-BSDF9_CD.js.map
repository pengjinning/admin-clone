{"version":3,"file":"index.ts-BSDF9_CD.js","sources":["../../src/content-scripts/analyzers/dom-analyzer.ts","../../src/content-scripts/analyzers/component-detector.ts","../../src/content-scripts/analyzers/table-analyzer.ts","../../src/content-scripts/analyzers/form-analyzer.ts","../../src/core/utils/css-parser.ts","../../src/content-scripts/analyzers/layout-analyzer.ts","../../src/content-scripts/analyzers/menu-analyzer.ts","../../src/content-scripts/traverser/load-detector.ts","../../src/content-scripts/traverser/navigation-controller.ts","../../src/content-scripts/traverser/interaction-controller.ts","../../src/content-scripts/index.ts"],"sourcesContent":["/**\n * DOM Analyzer - Base analyzer for extracting page structure\n */\n\nimport type { DOMSnapshot, LayoutInfo, LayoutRegion } from '@core/types/analysis';\nimport { \n  getBoundingBox, \n  isElementVisible, \n  getUniqueSelector,\n  findVisibleElements \n} from '@core/utils/dom-utils';\n\n/**\n * Layout detection selectors for common admin frameworks\n */\nconst LAYOUT_SELECTORS = {\n  header: [\n    '.ant-layout-header',\n    '.el-header',\n    '.arco-layout-header',\n    'header',\n    '[role=\"banner\"]',\n    '.header',\n    '.top-bar',\n    '.navbar',\n  ],\n  sidebar: [\n    '.ant-layout-sider',\n    '.el-aside',\n    '.arco-layout-sider',\n    'aside',\n    '[role=\"navigation\"]',\n    '.sidebar',\n    '.side-menu',\n    '.nav-menu',\n  ],\n  content: [\n    '.ant-layout-content',\n    '.el-main',\n    '.arco-layout-content',\n    'main',\n    '[role=\"main\"]',\n    '.content',\n    '.main-content',\n    '.page-content',\n  ],\n  footer: [\n    '.ant-layout-footer',\n    '.el-footer',\n    '.arco-layout-footer',\n    'footer',\n    '[role=\"contentinfo\"]',\n    '.footer',\n  ],\n  breadcrumb: [\n    '.ant-breadcrumb',\n    '.el-breadcrumb',\n    '.arco-breadcrumb',\n    '[aria-label=\"breadcrumb\"]',\n    '.breadcrumb',\n  ],\n};\n\n/**\n * Capture current DOM snapshot\n */\nexport function captureDOMSnapshot(): DOMSnapshot {\n  return {\n    html: document.documentElement.outerHTML,\n    url: window.location.href,\n    title: document.title,\n    timestamp: Date.now(),\n    viewport: {\n      width: window.innerWidth,\n      height: window.innerHeight,\n    },\n  };\n}\n\n/**\n * Find layout region element\n */\nfunction findLayoutElement(selectors: string[]): Element | null {\n  for (const selector of selectors) {\n    const elements = findVisibleElements(selector);\n    if (elements.length > 0) {\n      return elements[0];\n    }\n  }\n  return null;\n}\n\n/**\n * Analyze page layout structure\n */\nexport function analyzeLayout(): LayoutInfo {\n  const regions: LayoutRegion[] = [];\n  \n  // Find header\n  const header = findLayoutElement(LAYOUT_SELECTORS.header);\n  const hasHeader = header !== null;\n  if (header) {\n    regions.push({\n      type: 'header',\n      selector: getUniqueSelector(header),\n      boundingBox: getBoundingBox(header),\n    });\n  }\n  \n  // Find sidebar\n  const sidebar = findLayoutElement(LAYOUT_SELECTORS.sidebar);\n  const hasSidebar = sidebar !== null;\n  let sidebarPosition: 'left' | 'right' | undefined;\n  let sidebarWidth: number | undefined;\n  \n  if (sidebar) {\n    const box = getBoundingBox(sidebar);\n    sidebarWidth = box.width;\n    sidebarPosition = box.x < window.innerWidth / 2 ? 'left' : 'right';\n    \n    regions.push({\n      type: 'sidebar',\n      selector: getUniqueSelector(sidebar),\n      boundingBox: box,\n    });\n  }\n  \n  // Find content area\n  const content = findLayoutElement(LAYOUT_SELECTORS.content);\n  if (content) {\n    regions.push({\n      type: 'content',\n      selector: getUniqueSelector(content),\n      boundingBox: getBoundingBox(content),\n    });\n  }\n  \n  // Find footer\n  const footer = findLayoutElement(LAYOUT_SELECTORS.footer);\n  const hasFooter = footer !== null;\n  if (footer) {\n    regions.push({\n      type: 'footer',\n      selector: getUniqueSelector(footer),\n      boundingBox: getBoundingBox(footer),\n    });\n  }\n  \n  // Find breadcrumb\n  const breadcrumb = findLayoutElement(LAYOUT_SELECTORS.breadcrumb);\n  if (breadcrumb) {\n    regions.push({\n      type: 'breadcrumb',\n      selector: getUniqueSelector(breadcrumb),\n      boundingBox: getBoundingBox(breadcrumb),\n    });\n  }\n  \n  // Calculate header height\n  let headerHeight: number | undefined;\n  if (header) {\n    headerHeight = getBoundingBox(header).height;\n  }\n  \n  return {\n    hasHeader,\n    hasSidebar,\n    hasFooter,\n    sidebarPosition,\n    sidebarWidth,\n    headerHeight,\n    regions,\n  };\n}\n\n/**\n * Get the main content container element\n */\nexport function getContentContainer(): Element {\n  // Try to find the main content area\n  const content = findLayoutElement(LAYOUT_SELECTORS.content);\n  if (content) {\n    return content;\n  }\n  \n  // Fallback: find the largest visible container\n  const containers = document.querySelectorAll('div, section, main, article');\n  let largest: Element | null = null;\n  let largestArea = 0;\n  \n  for (const container of containers) {\n    if (!isElementVisible(container)) continue;\n    \n    const rect = container.getBoundingClientRect();\n    const area = rect.width * rect.height;\n    \n    // Skip very small or full-page containers\n    if (area < 10000 || area > window.innerWidth * window.innerHeight * 0.9) continue;\n    \n    if (area > largestArea) {\n      largestArea = area;\n      largest = container;\n    }\n  }\n  \n  return largest || document.body;\n}\n\n/**\n * Detect the UI framework being used on the page\n */\nexport function detectUIFramework(): 'antd' | 'element' | 'arco' | 'unknown' {\n  // Check for Ant Design\n  if (document.querySelector('.ant-layout, .ant-btn, .ant-table')) {\n    return 'antd';\n  }\n  \n  // Check for Element Plus\n  if (document.querySelector('.el-container, .el-button, .el-table')) {\n    return 'element';\n  }\n  \n  // Check for Arco Design\n  if (document.querySelector('.arco-layout, .arco-btn, .arco-table')) {\n    return 'arco';\n  }\n  \n  return 'unknown';\n}\n\n/**\n * Get page metadata\n */\nexport function getPageMetadata(): {\n  url: string;\n  title: string;\n  path: string;\n  framework: string;\n} {\n  return {\n    url: window.location.href,\n    title: document.title,\n    path: window.location.pathname,\n    framework: detectUIFramework(),\n  };\n}\n","/**\n * Component Detector - Detect and recognize UI components using heuristic rules\n */\n\nimport type { \n  RecognizedComponent, \n  ComponentType,\n} from '@core/types/component';\nimport { \n  getBoundingBox, \n  getUniqueSelector,\n  getClassList,\n  isElementVisible,\n} from '@core/utils/dom-utils';\nimport { getContentContainer } from './dom-analyzer';\n\n/**\n * Generate a unique component ID\n */\nfunction generateComponentId(): string {\n  return `comp-${Date.now()}-${Math.random().toString(36).substring(2, 9)}`;\n}\n\n/**\n * Detect component type from CSS classes\n */\nexport function detectComponentType(element: Element): ComponentType {\n  const classes = getClassList(element);\n  \n  // Check Ant Design classes\n  for (const cls of classes) {\n    if (cls.startsWith('ant-table')) return 'table';\n    if (cls.startsWith('ant-form') && !cls.includes('item')) return 'form';\n    if (cls.startsWith('ant-btn')) return 'button';\n    if (cls.startsWith('ant-modal')) return 'modal';\n    if (cls.startsWith('ant-card')) return 'card';\n    if (cls.startsWith('ant-tabs')) return 'tabs';\n    if (cls.startsWith('ant-menu')) return 'menu';\n    if (cls.startsWith('ant-breadcrumb')) return 'breadcrumb';\n    if (cls.startsWith('ant-pagination')) return 'pagination';\n    if (cls.startsWith('ant-input')) return 'input';\n    if (cls.startsWith('ant-select')) return 'select';\n    if (cls.startsWith('ant-checkbox')) return 'checkbox';\n    if (cls.startsWith('ant-radio')) return 'radio';\n    if (cls.startsWith('ant-switch')) return 'switch';\n    if (cls.startsWith('ant-picker')) return 'datepicker';\n    if (cls.startsWith('ant-upload')) return 'upload';\n    if (cls.startsWith('ant-tree') && !cls.includes('select')) return 'tree';\n    if (cls.startsWith('ant-transfer')) return 'transfer';\n  }\n  \n  // Check Element Plus classes\n  for (const cls of classes) {\n    if (cls.startsWith('el-table')) return 'table';\n    if (cls.startsWith('el-form') && !cls.includes('item')) return 'form';\n    if (cls.startsWith('el-button')) return 'button';\n    if (cls.startsWith('el-dialog')) return 'modal';\n    if (cls.startsWith('el-card')) return 'card';\n    if (cls.startsWith('el-tabs')) return 'tabs';\n    if (cls.startsWith('el-menu')) return 'menu';\n    if (cls.startsWith('el-breadcrumb')) return 'breadcrumb';\n    if (cls.startsWith('el-pagination')) return 'pagination';\n    if (cls.startsWith('el-input')) return 'input';\n    if (cls.startsWith('el-select')) return 'select';\n    if (cls.startsWith('el-checkbox')) return 'checkbox';\n    if (cls.startsWith('el-radio')) return 'radio';\n    if (cls.startsWith('el-switch')) return 'switch';\n    if (cls.startsWith('el-date-picker')) return 'datepicker';\n    if (cls.startsWith('el-upload')) return 'upload';\n    if (cls.startsWith('el-tree')) return 'tree';\n    if (cls.startsWith('el-transfer')) return 'transfer';\n  }\n  \n  // Check Arco Design classes\n  for (const cls of classes) {\n    if (cls.startsWith('arco-table')) return 'table';\n    if (cls.startsWith('arco-form') && !cls.includes('item')) return 'form';\n    if (cls.startsWith('arco-btn')) return 'button';\n    if (cls.startsWith('arco-modal')) return 'modal';\n    if (cls.startsWith('arco-card')) return 'card';\n    if (cls.startsWith('arco-tabs')) return 'tabs';\n    if (cls.startsWith('arco-menu')) return 'menu';\n  }\n  \n  // Check by tag name\n  const tagName = element.tagName.toLowerCase();\n  if (tagName === 'table') return 'table';\n  if (tagName === 'form') return 'form';\n  if (tagName === 'button') return 'button';\n  if (tagName === 'input') return 'input';\n  if (tagName === 'select') return 'select';\n  if (tagName === 'textarea') return 'input';\n  \n  // Check by role attribute\n  const role = element.getAttribute('role');\n  if (role === 'table' || role === 'grid') return 'table';\n  if (role === 'form') return 'form';\n  if (role === 'button') return 'button';\n  if (role === 'dialog') return 'modal';\n  if (role === 'tablist') return 'tabs';\n  if (role === 'menu' || role === 'navigation') return 'menu';\n  \n  return 'unknown';\n}\n\n/**\n * Calculate confidence score for component detection\n */\nfunction calculateConfidence(element: Element, type: ComponentType): number {\n  if (type === 'unknown') return 0.1;\n  \n  const classes = getClassList(element);\n  let confidence = 0.5;\n  \n  // Higher confidence for explicit framework classes\n  const hasAntd = classes.some(c => c.startsWith('ant-'));\n  const hasElement = classes.some(c => c.startsWith('el-'));\n  const hasArco = classes.some(c => c.startsWith('arco-'));\n  \n  if (hasAntd || hasElement || hasArco) {\n    confidence = 0.9;\n  }\n  \n  // Check for ARIA attributes\n  if (element.getAttribute('role')) {\n    confidence += 0.1;\n  }\n  \n  // Check for data attributes\n  if (element.hasAttribute('data-testid') || element.hasAttribute('data-cy')) {\n    confidence += 0.05;\n  }\n  \n  return Math.min(confidence, 1);\n}\n\n/**\n * Generate component name from element\n */\nfunction generateComponentName(element: Element, type: ComponentType, index: number): string {\n  // Try to get a meaningful name from attributes\n  const testId = element.getAttribute('data-testid');\n  if (testId) {\n    return toPascalCase(testId);\n  }\n  \n  const id = element.id;\n  if (id) {\n    return toPascalCase(id);\n  }\n  \n  // Try to get name from aria-label\n  const ariaLabel = element.getAttribute('aria-label');\n  if (ariaLabel) {\n    return toPascalCase(ariaLabel);\n  }\n  \n  // Try to get name from heading inside component\n  const heading = element.querySelector('h1, h2, h3, h4, .ant-card-head-title, .el-card__header');\n  if (heading && heading.textContent) {\n    const text = heading.textContent.trim().substring(0, 20);\n    if (text) {\n      return toPascalCase(text);\n    }\n  }\n  \n  // Fallback to type + index\n  return `${toPascalCase(type)}${index + 1}`;\n}\n\n/**\n * Convert string to PascalCase\n */\nfunction toPascalCase(str: string): string {\n  return str\n    .replace(/[^a-zA-Z0-9\\s]/g, ' ')\n    .split(/\\s+/)\n    .filter(Boolean)\n    .map(word => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())\n    .join('');\n}\n\n/**\n * Component selectors for detection\n */\nconst COMPONENT_SELECTORS: Record<ComponentType, string[]> = {\n  table: ['.ant-table', '.el-table', '.arco-table', 'table[role=\"grid\"]', '.data-table'],\n  form: ['.ant-form', '.el-form', '.arco-form', 'form'],\n  button: ['.ant-btn', '.el-button', '.arco-btn', 'button:not([class*=\"close\"])'],\n  modal: ['.ant-modal', '.el-dialog', '.arco-modal', '[role=\"dialog\"]'],\n  card: ['.ant-card', '.el-card', '.arco-card'],\n  tabs: ['.ant-tabs', '.el-tabs', '.arco-tabs', '[role=\"tablist\"]'],\n  menu: [], // Handled separately by menu analyzer\n  breadcrumb: ['.ant-breadcrumb', '.el-breadcrumb', '.arco-breadcrumb'],\n  pagination: ['.ant-pagination', '.el-pagination', '.arco-pagination'],\n  input: ['.ant-input:not(.ant-input-affix-wrapper .ant-input)', '.el-input', '.arco-input'],\n  select: ['.ant-select', '.el-select', '.arco-select'],\n  checkbox: ['.ant-checkbox', '.el-checkbox', '.arco-checkbox'],\n  radio: ['.ant-radio', '.el-radio', '.arco-radio'],\n  switch: ['.ant-switch', '.el-switch', '.arco-switch'],\n  datepicker: ['.ant-picker', '.el-date-picker', '.arco-picker'],\n  upload: ['.ant-upload', '.el-upload', '.arco-upload'],\n  tree: ['.ant-tree:not(.ant-tree-select)', '.el-tree', '.arco-tree'],\n  transfer: ['.ant-transfer', '.el-transfer', '.arco-transfer'],\n  unknown: [],\n};\n\n/**\n * Detect all components in a container\n */\nexport function detectComponents(container: Element = document.body): RecognizedComponent[] {\n  const components: RecognizedComponent[] = [];\n  const processedElements = new Set<Element>();\n  \n  // Define priority order for component types\n  const typePriority: ComponentType[] = [\n    'table',\n    'form', \n    'modal',\n    'card',\n    'tabs',\n    'tree',\n    'transfer',\n    'upload',\n    'pagination',\n    'breadcrumb',\n    'select',\n    'datepicker',\n    'input',\n    'checkbox',\n    'radio',\n    'switch',\n    'button',\n  ];\n  \n  // Detect components by type priority\n  for (const type of typePriority) {\n    const selectors = COMPONENT_SELECTORS[type];\n    if (!selectors || selectors.length === 0) continue;\n    \n    const selectorString = selectors.join(', ');\n    const elements = container.querySelectorAll(selectorString);\n    \n    for (const element of elements) {\n      // Skip if already processed or not visible\n      if (processedElements.has(element) || !isElementVisible(element)) {\n        continue;\n      }\n      \n      // Skip if inside another component of the same type\n      const parent = element.parentElement;\n      if (parent && processedElements.has(parent)) {\n        continue;\n      }\n      \n      // Create component\n      const component = createComponent(element, type, components.length);\n      components.push(component);\n      processedElements.add(element);\n    }\n  }\n  \n  return components;\n}\n\n/**\n * Create a recognized component from an element\n */\nfunction createComponent(\n  element: Element, \n  type: ComponentType, \n  index: number\n): RecognizedComponent {\n  return {\n    id: generateComponentId(),\n    type,\n    name: generateComponentName(element, type, index),\n    config: {}, // Config will be filled by specific analyzers\n    boundingBox: getBoundingBox(element),\n    cssClasses: getClassList(element),\n    sourceSelector: getUniqueSelector(element),\n    confidence: calculateConfidence(element, type),\n  };\n}\n\n/**\n * Analyze a page and return all detected components\n */\nexport function analyzePageComponents(): RecognizedComponent[] {\n  const contentContainer = getContentContainer();\n  return detectComponents(contentContainer);\n}\n","/**\n * Table Analyzer - Extract table structure and configuration\n */\n\nimport type { RecognizedComponent, TableConfig, TableColumnConfig } from '@core/types/component';\nimport { getVisibleText } from '@core/utils/dom-utils';\n\n/**\n * Table selectors for different frameworks\n */\nconst TABLE_SELECTORS = {\n  container: ['.ant-table', '.el-table', '.arco-table', 'table'],\n  header: ['.ant-table-thead', '.el-table__header', '.arco-table-header', 'thead'],\n  headerCell: ['.ant-table-cell', '.el-table__cell', '.arco-table-th', 'th'],\n  body: ['.ant-table-tbody', '.el-table__body', '.arco-table-body', 'tbody'],\n  row: ['.ant-table-row', '.el-table__row', '.arco-table-tr', 'tr'],\n  cell: ['.ant-table-cell', '.el-table__cell', '.arco-table-td', 'td'],\n  pagination: ['.ant-pagination', '.el-pagination', '.arco-pagination'],\n  actions: ['.ant-table-cell .ant-btn', '.el-table__cell .el-button', '.arco-table-td .arco-btn'],\n};\n\n/**\n * Find element using multiple selectors\n */\nfunction findElement(container: Element, selectors: string[]): Element | null {\n  for (const selector of selectors) {\n    const element = container.querySelector(selector);\n    if (element) return element;\n  }\n  return null;\n}\n\n/**\n * Find all elements using multiple selectors\n */\nfunction findElements(container: Element, selectors: string[]): Element[] {\n  for (const selector of selectors) {\n    const elements = container.querySelectorAll(selector);\n    if (elements.length > 0) return Array.from(elements);\n  }\n  return [];\n}\n\n/**\n * Extract column configuration from header\n */\nfunction extractColumns(tableElement: Element): TableColumnConfig[] {\n  const columns: TableColumnConfig[] = [];\n  \n  // Find header cells\n  const headerCells = findElements(tableElement, TABLE_SELECTORS.headerCell);\n  \n  headerCells.forEach((cell, index) => {\n    // Skip checkbox/selection columns\n    if (cell.querySelector('.ant-checkbox, .el-checkbox, .arco-checkbox')) {\n      return;\n    }\n    \n    // Skip expand columns\n    if (cell.querySelector('.ant-table-row-expand-icon, .el-table__expand-icon')) {\n      return;\n    }\n    \n    const title = getVisibleText(cell);\n    if (!title || title === '操作' || title === 'Actions') {\n      // This might be an action column\n      if (title === '操作' || title === 'Actions') {\n        columns.push({\n          key: `action_${index}`,\n          title,\n          dataIndex: 'actions',\n          render: 'actions',\n        });\n      }\n      return;\n    }\n    \n    // Get column key from data attribute or generate one\n    const dataIndex = \n      cell.getAttribute('data-key') || \n      cell.getAttribute('data-field') ||\n      generateDataIndex(title);\n    \n    // Check for sorter\n    const hasSorter = cell.querySelector('.ant-table-column-sorter, .el-table__sort, .arco-table-sorter') !== null;\n    \n    // Check for fixed\n    const isFixed = cell.classList.contains('ant-table-cell-fix-left') || \n                   cell.classList.contains('ant-table-cell-fix-right') ||\n                   cell.classList.contains('el-table-fixed-column');\n    \n    // Get width if specified\n    const style = window.getComputedStyle(cell);\n    const width = style.width !== 'auto' ? parseInt(style.width) : undefined;\n    \n    columns.push({\n      key: dataIndex,\n      title,\n      dataIndex,\n      width,\n      sorter: hasSorter,\n      fixed: isFixed ? (cell.classList.contains('ant-table-cell-fix-left') ? 'left' : 'right') : undefined,\n      ellipsis: cell.classList.contains('ant-table-cell-ellipsis'),\n    });\n  });\n  \n  return columns;\n}\n\n/**\n * Generate data index from title (Chinese or English)\n */\nfunction generateDataIndex(title: string): string {\n  // Simple mapping for common Chinese column names\n  const commonMappings: Record<string, string> = {\n    '序号': 'index',\n    '编号': 'id',\n    'ID': 'id',\n    '名称': 'name',\n    '标题': 'title',\n    '描述': 'description',\n    '创建时间': 'createdAt',\n    '更新时间': 'updatedAt',\n    '状态': 'status',\n    '操作': 'actions',\n    '类型': 'type',\n    '金额': 'amount',\n    '数量': 'quantity',\n    '用户': 'user',\n    '姓名': 'name',\n    '邮箱': 'email',\n    '手机': 'phone',\n    '电话': 'phone',\n    '地址': 'address',\n  };\n  \n  if (commonMappings[title]) {\n    return commonMappings[title];\n  }\n  \n  // Convert to camelCase for English\n  return title\n    .toLowerCase()\n    .replace(/[^a-z0-9\\s]/g, '')\n    .split(/\\s+/)\n    .map((word, index) => \n      index === 0 ? word : word.charAt(0).toUpperCase() + word.slice(1)\n    )\n    .join('') || `column_${Date.now()}`;\n}\n\n/**\n * Extract pagination configuration\n */\nfunction extractPagination(tableContainer: Element): TableConfig['pagination'] | undefined {\n  // Find pagination element\n  const pagination = findElement(tableContainer, TABLE_SELECTORS.pagination);\n  \n  if (!pagination) {\n    return undefined;\n  }\n  \n  // Try to detect page size\n  const pageSizeSelect = pagination.querySelector('.ant-pagination-options-size-changer, .el-pagination__sizes');\n  const pageSizeText = pageSizeSelect?.textContent;\n  const pageSize = pageSizeText ? parseInt(pageSizeText) || 10 : 10;\n  \n  // Check for size changer\n  const showSizeChanger = pagination.querySelector('.ant-pagination-options, .el-pagination__sizes') !== null;\n  \n  // Check for total display\n  const showTotal = pagination.querySelector('.ant-pagination-total-text, .el-pagination__total') !== null;\n  \n  return {\n    pageSize,\n    showSizeChanger,\n    showTotal,\n  };\n}\n\n/**\n * Extract action buttons from table\n */\nfunction extractActions(tableElement: Element): TableConfig['actions'] {\n  const actions: TableConfig['actions'] = [];\n  \n  // Find action buttons in the first row\n  const firstRow = findElement(tableElement, TABLE_SELECTORS.row);\n  if (!firstRow) return actions;\n  \n  const buttons = firstRow.querySelectorAll('.ant-btn, .el-button, .arco-btn, button, a[class*=\"link\"]');\n  \n  buttons.forEach((button, index) => {\n    const text = getVisibleText(button);\n    if (!text) return;\n    \n    const isDanger = button.classList.contains('ant-btn-dangerous') ||\n                    button.classList.contains('el-button--danger') ||\n                    button.classList.contains('arco-btn-status-danger');\n    \n    const isLink = button.tagName.toLowerCase() === 'a' ||\n                  button.classList.contains('ant-btn-link') ||\n                  button.classList.contains('el-button--text');\n    \n    actions.push({\n      key: `action_${index}`,\n      label: text,\n      type: isLink ? 'link' : 'button',\n      danger: isDanger,\n    });\n  });\n  \n  return actions;\n}\n\n/**\n * Analyze a table element and extract configuration\n */\nexport function analyzeTable(element: Element): TableConfig {\n  const columns = extractColumns(element);\n  const pagination = extractPagination(element.parentElement || element);\n  const actions = extractActions(element);\n  \n  // Check table properties\n  const bordered = element.classList.contains('ant-table-bordered') ||\n                  element.querySelector('.ant-table-bordered') !== null;\n  \n  // Try to detect row key\n  const firstRow = findElement(element, TABLE_SELECTORS.row);\n  const rowKey = firstRow?.getAttribute('data-row-key') || 'id';\n  \n  return {\n    columns,\n    pagination,\n    rowKey,\n    bordered,\n    actions: actions && actions.length > 0 ? actions : undefined,\n  };\n}\n\n/**\n * Enhance a recognized table component with detailed config\n */\nexport function enhanceTableComponent(component: RecognizedComponent): RecognizedComponent {\n  // Find the actual table element\n  const tableElement = document.querySelector(component.sourceSelector);\n  if (!tableElement) return component;\n  \n  const config = analyzeTable(tableElement);\n  \n  return {\n    ...component,\n    config,\n  };\n}\n","/**\n * Form Analyzer - Extract form structure and configuration\n */\n\nimport type { RecognizedComponent, FormConfig, FormFieldConfig } from '@core/types/component';\nimport { getVisibleText, getClassList } from '@core/utils/dom-utils';\n\n/**\n * Form selectors for different frameworks\n */\nconst FORM_SELECTORS = {\n  container: ['.ant-form', '.el-form', '.arco-form', 'form'],\n  item: ['.ant-form-item', '.el-form-item', '.arco-form-item'],\n  label: ['.ant-form-item-label', '.el-form-item__label', '.arco-form-item-label', 'label'],\n  control: ['.ant-form-item-control', '.el-form-item__content', '.arco-form-item-wrapper'],\n  required: ['.ant-form-item-required', '.el-form-item__label.is-required', '.arco-form-item-label-required'],\n};\n\n/**\n * Input type detection patterns\n */\nconst INPUT_TYPE_SELECTORS: Record<FormFieldConfig['type'], string[]> = {\n  input: ['.ant-input', '.el-input', '.arco-input', 'input[type=\"text\"]', 'input[type=\"password\"]', 'input:not([type])'],\n  textarea: ['.ant-input-textarea', '.el-textarea', '.arco-textarea', 'textarea'],\n  number: ['.ant-input-number', '.el-input-number', '.arco-input-number', 'input[type=\"number\"]'],\n  select: ['.ant-select', '.el-select', '.arco-select', 'select'],\n  checkbox: ['.ant-checkbox', '.el-checkbox', '.arco-checkbox', 'input[type=\"checkbox\"]'],\n  radio: ['.ant-radio', '.el-radio', '.arco-radio', 'input[type=\"radio\"]'],\n  switch: ['.ant-switch', '.el-switch', '.arco-switch'],\n  datepicker: ['.ant-picker', '.el-date-picker', '.arco-picker', 'input[type=\"date\"]'],\n  upload: ['.ant-upload', '.el-upload', '.arco-upload', 'input[type=\"file\"]'],\n};\n\n/**\n * Find element using multiple selectors\n */\nfunction findElement(container: Element, selectors: string[]): Element | null {\n  for (const selector of selectors) {\n    const element = container.querySelector(selector);\n    if (element) return element;\n  }\n  return null;\n}\n\n/**\n * Find all elements using multiple selectors\n */\nfunction findElements(container: Element, selectors: string[]): Element[] {\n  for (const selector of selectors) {\n    const elements = container.querySelectorAll(selector);\n    if (elements.length > 0) return Array.from(elements);\n  }\n  return [];\n}\n\n/**\n * Detect field type from control element\n */\nfunction detectFieldType(controlElement: Element): FormFieldConfig['type'] {\n  for (const [type, selectors] of Object.entries(INPUT_TYPE_SELECTORS)) {\n    for (const selector of selectors) {\n      if (controlElement.querySelector(selector)) {\n        return type as FormFieldConfig['type'];\n      }\n    }\n  }\n  return 'input';\n}\n\n/**\n * Generate field name from label\n */\nfunction generateFieldName(label: string): string {\n  // Common Chinese to English mappings\n  const commonMappings: Record<string, string> = {\n    '用户名': 'username',\n    '密码': 'password',\n    '确认密码': 'confirmPassword',\n    '邮箱': 'email',\n    '手机号': 'phone',\n    '手机': 'phone',\n    '电话': 'phone',\n    '姓名': 'name',\n    '名称': 'name',\n    '标题': 'title',\n    '描述': 'description',\n    '内容': 'content',\n    '地址': 'address',\n    '备注': 'remark',\n    '状态': 'status',\n    '类型': 'type',\n    '日期': 'date',\n    '时间': 'time',\n    '开始时间': 'startTime',\n    '结束时间': 'endTime',\n    '创建时间': 'createdAt',\n    '更新时间': 'updatedAt',\n    '金额': 'amount',\n    '数量': 'quantity',\n    '价格': 'price',\n    '排序': 'sort',\n    '权限': 'permissions',\n    '角色': 'role',\n    '部门': 'department',\n    '公司': 'company',\n    '图片': 'image',\n    '头像': 'avatar',\n    '附件': 'attachment',\n  };\n  \n  if (commonMappings[label]) {\n    return commonMappings[label];\n  }\n  \n  // Convert to camelCase\n  return label\n    .toLowerCase()\n    .replace(/[^a-z0-9\\s]/g, '')\n    .split(/\\s+/)\n    .filter(Boolean)\n    .map((word, index) => \n      index === 0 ? word : word.charAt(0).toUpperCase() + word.slice(1)\n    )\n    .join('') || `field_${Date.now()}`;\n}\n\n/**\n * Extract placeholder from input element\n */\nfunction extractPlaceholder(controlElement: Element): string | undefined {\n  const input = controlElement.querySelector('input, textarea, .ant-select-selection-placeholder');\n  if (!input) return undefined;\n  \n  if (input.classList.contains('ant-select-selection-placeholder')) {\n    return getVisibleText(input);\n  }\n  \n  return (input as HTMLInputElement).placeholder || undefined;\n}\n\n/**\n * Extract select options\n */\nfunction extractSelectOptions(controlElement: Element): FormFieldConfig['options'] {\n  // For native select\n  const nativeSelect = controlElement.querySelector('select');\n  if (nativeSelect) {\n    return Array.from(nativeSelect.options).map(opt => ({\n      label: opt.text,\n      value: opt.value,\n    }));\n  }\n  \n  // For Ant Design / Element Plus selects, options are usually in dropdown\n  // We can only detect if there are visible options\n  return undefined;\n}\n\n/**\n * Extract form fields from form element\n */\nfunction extractFields(formElement: Element): FormFieldConfig[] {\n  const fields: FormFieldConfig[] = [];\n  const formItems = findElements(formElement, FORM_SELECTORS.item);\n  \n  formItems.forEach((item) => {\n    // Get label\n    const labelElement = findElement(item, FORM_SELECTORS.label);\n    const label = labelElement ? getVisibleText(labelElement).replace(/[：:]/g, '').trim() : '';\n    \n    if (!label) return; // Skip items without labels\n    \n    // Get control element\n    const controlElement = findElement(item, FORM_SELECTORS.control) || item;\n    \n    // Detect field type\n    const type = detectFieldType(controlElement);\n    \n    // Check if required\n    const required = item.querySelector(FORM_SELECTORS.required.join(', ')) !== null ||\n                    labelElement?.classList.contains('ant-form-item-required') ||\n                    item.classList.contains('is-required');\n    \n    // Generate field name\n    const name = generateFieldName(label);\n    \n    // Extract placeholder\n    const placeholder = extractPlaceholder(controlElement);\n    \n    // Extract options for select\n    const options = type === 'select' ? extractSelectOptions(controlElement) : undefined;\n    \n    // Detect grid span (for inline forms)\n    let span: number | undefined;\n    const colElement = item.closest('.ant-col, .el-col');\n    if (colElement) {\n      const spanClass = Array.from(colElement.classList).find(c => c.match(/ant-col-\\d+|el-col-\\d+/));\n      if (spanClass) {\n        const match = spanClass.match(/\\d+/);\n        span = match ? parseInt(match[0]) : undefined;\n      }\n    }\n    \n    fields.push({\n      name,\n      label,\n      type,\n      required,\n      placeholder,\n      options,\n      span,\n    });\n  });\n  \n  return fields;\n}\n\n/**\n * Detect form layout\n */\nfunction detectLayout(formElement: Element): FormConfig['layout'] {\n  const classes = getClassList(formElement);\n  \n  if (classes.includes('ant-form-inline') || classes.includes('el-form--inline')) {\n    return 'inline';\n  }\n  \n  if (classes.includes('ant-form-vertical') || classes.includes('el-form--label-top')) {\n    return 'vertical';\n  }\n  \n  return 'horizontal';\n}\n\n/**\n * Extract label column width\n */\nfunction extractLabelCol(formElement: Element): number | undefined {\n  // Try to find label col setting\n  const labelAttr = formElement.getAttribute('labelcol') || \n                   formElement.getAttribute('label-width');\n  \n  if (labelAttr) {\n    const match = labelAttr.match(/\\d+/);\n    return match ? parseInt(match[0]) : undefined;\n  }\n  \n  // Detect from first form item\n  const firstLabel = formElement.querySelector('.ant-form-item-label, .el-form-item__label');\n  if (firstLabel) {\n    const colElement = firstLabel.closest('.ant-col');\n    if (colElement) {\n      const spanClass = Array.from(colElement.classList).find(c => c.match(/ant-col-\\d+/));\n      if (spanClass) {\n        const match = spanClass.match(/\\d+/);\n        return match ? parseInt(match[0]) : undefined;\n      }\n    }\n  }\n  \n  return undefined;\n}\n\n/**\n * Extract submit/cancel button text\n */\nfunction extractButtonTexts(formElement: Element): { submitText?: string; cancelText?: string } {\n  const buttons = formElement.querySelectorAll('.ant-btn, .el-button, .arco-btn, button');\n  \n  let submitText: string | undefined;\n  let cancelText: string | undefined;\n  \n  buttons.forEach(button => {\n    const text = getVisibleText(button);\n    const isPrimary = button.classList.contains('ant-btn-primary') ||\n                     button.classList.contains('el-button--primary') ||\n                     button.classList.contains('arco-btn-primary');\n    \n    if (isPrimary || text.includes('提交') || text.includes('保存') || text.includes('确定')) {\n      submitText = text;\n    } else if (text.includes('取消') || text.includes('重置')) {\n      cancelText = text;\n    }\n  });\n  \n  return { submitText, cancelText };\n}\n\n/**\n * Analyze a form element and extract configuration\n */\nexport function analyzeForm(element: Element): FormConfig {\n  const fields = extractFields(element);\n  const layout = detectLayout(element);\n  const labelCol = extractLabelCol(element);\n  const { submitText, cancelText } = extractButtonTexts(element);\n  \n  // Calculate wrapper col based on label col\n  const wrapperCol = labelCol ? 24 - labelCol : undefined;\n  \n  return {\n    fields,\n    layout,\n    labelCol,\n    wrapperCol,\n    submitText,\n    cancelText,\n  };\n}\n\n/**\n * Enhance a recognized form component with detailed config\n */\nexport function enhanceFormComponent(component: RecognizedComponent): RecognizedComponent {\n  // Find the actual form element\n  const formElement = document.querySelector(component.sourceSelector);\n  if (!formElement) return component;\n  \n  const config = analyzeForm(formElement);\n  \n  return {\n    ...component,\n    config,\n  };\n}\n","/**\n * CSS Parser Utilities - Helpers for parsing and analyzing CSS\n */\n\n/**\n * Parsed CSS rule\n */\nexport interface ParsedCSSRule {\n  selector: string;\n  properties: Record<string, string>;\n}\n\n/**\n * Extract CSS properties from an element's computed style\n */\nexport function getComputedStyleProperties(\n  element: Element, \n  properties: string[]\n): Record<string, string> {\n  const style = window.getComputedStyle(element);\n  const result: Record<string, string> = {};\n  \n  for (const prop of properties) {\n    result[prop] = style.getPropertyValue(prop);\n  }\n  \n  return result;\n}\n\n/**\n * Get layout-related CSS properties\n */\nexport function getLayoutProperties(element: Element): Record<string, string> {\n  return getComputedStyleProperties(element, [\n    'display',\n    'position',\n    'flex-direction',\n    'justify-content',\n    'align-items',\n    'grid-template-columns',\n    'grid-template-rows',\n    'width',\n    'height',\n    'margin',\n    'padding',\n    'overflow',\n  ]);\n}\n\n/**\n * Get typography CSS properties\n */\nexport function getTypographyProperties(element: Element): Record<string, string> {\n  return getComputedStyleProperties(element, [\n    'font-family',\n    'font-size',\n    'font-weight',\n    'line-height',\n    'color',\n    'text-align',\n  ]);\n}\n\n/**\n * Parse inline style string\n */\nexport function parseInlineStyle(styleString: string): Record<string, string> {\n  const result: Record<string, string> = {};\n  \n  if (!styleString) return result;\n  \n  const declarations = styleString.split(';');\n  for (const decl of declarations) {\n    const [property, value] = decl.split(':').map(s => s.trim());\n    if (property && value) {\n      result[property] = value;\n    }\n  }\n  \n  return result;\n}\n\n/**\n * Check if element uses flexbox layout\n */\nexport function isFlexContainer(element: Element): boolean {\n  const display = window.getComputedStyle(element).display;\n  return display === 'flex' || display === 'inline-flex';\n}\n\n/**\n * Check if element uses grid layout\n */\nexport function isGridContainer(element: Element): boolean {\n  const display = window.getComputedStyle(element).display;\n  return display === 'grid' || display === 'inline-grid';\n}\n\n/**\n * Detect layout type of an element\n */\nexport function detectLayoutType(element: Element): 'flex' | 'grid' | 'block' | 'inline' | 'other' {\n  const display = window.getComputedStyle(element).display;\n  \n  if (display === 'flex' || display === 'inline-flex') return 'flex';\n  if (display === 'grid' || display === 'inline-grid') return 'grid';\n  if (display === 'block') return 'block';\n  if (display === 'inline' || display === 'inline-block') return 'inline';\n  \n  return 'other';\n}\n\n/**\n * Get color value in hex format\n */\nexport function rgbToHex(rgb: string): string {\n  const match = rgb.match(/rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)/);\n  if (!match) return rgb;\n  \n  const r = parseInt(match[1], 10);\n  const g = parseInt(match[2], 10);\n  const b = parseInt(match[3], 10);\n  \n  return `#${((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1)}`;\n}\n\n/**\n * Extract CSS class patterns that match component libraries\n */\nexport function extractComponentClasses(element: Element): {\n  antd: string[];\n  element: string[];\n  arco: string[];\n  other: string[];\n} {\n  const classes = Array.from(element.classList);\n  \n  return {\n    antd: classes.filter(c => c.startsWith('ant-')),\n    element: classes.filter(c => c.startsWith('el-')),\n    arco: classes.filter(c => c.startsWith('arco-')),\n    other: classes.filter(c => !c.startsWith('ant-') && !c.startsWith('el-') && !c.startsWith('arco-')),\n  };\n}\n\n/**\n * Get responsive breakpoint based on width\n */\nexport function getBreakpoint(width: number): 'xs' | 'sm' | 'md' | 'lg' | 'xl' | 'xxl' {\n  if (width < 576) return 'xs';\n  if (width < 768) return 'sm';\n  if (width < 992) return 'md';\n  if (width < 1200) return 'lg';\n  if (width < 1600) return 'xl';\n  return 'xxl';\n}\n\n/**\n * Parse CSS selector to extract tag, class, and id\n */\nexport function parseSelectorParts(selector: string): {\n  tag?: string;\n  id?: string;\n  classes: string[];\n  attributes: Array<{ name: string; value?: string }>;\n} {\n  const result: {\n    tag?: string;\n    id?: string;\n    classes: string[];\n    attributes: Array<{ name: string; value?: string }>;\n  } = {\n    classes: [],\n    attributes: [],\n  };\n  \n  // Extract tag\n  const tagMatch = selector.match(/^([a-zA-Z][a-zA-Z0-9]*)/);\n  if (tagMatch) {\n    result.tag = tagMatch[1];\n  }\n  \n  // Extract ID\n  const idMatch = selector.match(/#([a-zA-Z][a-zA-Z0-9_-]*)/);\n  if (idMatch) {\n    result.id = idMatch[1];\n  }\n  \n  // Extract classes\n  const classMatches = selector.match(/\\.([a-zA-Z][a-zA-Z0-9_-]*)/g);\n  if (classMatches) {\n    result.classes = classMatches.map(c => c.substring(1));\n  }\n  \n  // Extract attributes\n  const attrMatches = selector.match(/\\[([^\\]]+)\\]/g);\n  if (attrMatches) {\n    for (const attr of attrMatches) {\n      const parts = attr.slice(1, -1).split('=');\n      result.attributes.push({\n        name: parts[0],\n        value: parts[1]?.replace(/['\"]/g, ''),\n      });\n    }\n  }\n  \n  return result;\n}\n\n/**\n * Check if element has fixed or sticky position\n */\nexport function isFixedOrSticky(element: Element): boolean {\n  const position = window.getComputedStyle(element).position;\n  return position === 'fixed' || position === 'sticky';\n}\n\n/**\n * Get z-index of element\n */\nexport function getZIndex(element: Element): number {\n  const zIndex = window.getComputedStyle(element).zIndex;\n  return zIndex === 'auto' ? 0 : parseInt(zIndex, 10);\n}\n","/**\n * Layout Analyzer - Analyze page layout structure\n */\n\nimport type { LayoutInfo, LayoutRegion } from '@core/types/analysis';\nimport { \n  getBoundingBox, \n  getUniqueSelector, \n  isElementVisible,\n  findVisibleElements \n} from '@core/utils/dom-utils';\nimport { isFixedOrSticky } from '@core/utils/css-parser';\n\n/**\n * Layout detection configuration\n */\ninterface LayoutDetectionConfig {\n  headerSelectors: string[];\n  sidebarSelectors: string[];\n  contentSelectors: string[];\n  footerSelectors: string[];\n  breadcrumbSelectors: string[];\n}\n\n/**\n * Default layout selectors for common UI frameworks\n */\nconst DEFAULT_LAYOUT_CONFIG: LayoutDetectionConfig = {\n  headerSelectors: [\n    // Ant Design\n    '.ant-layout-header',\n    // Element Plus\n    '.el-header',\n    '.el-menu--horizontal',\n    // Arco Design\n    '.arco-layout-header',\n    // Generic\n    'header',\n    '[role=\"banner\"]',\n    '.header',\n    '.top-bar',\n    '.navbar',\n    '.nav-header',\n    '#header',\n  ],\n  sidebarSelectors: [\n    // Ant Design\n    '.ant-layout-sider',\n    '.ant-menu:not(.ant-menu-horizontal)',\n    // Element Plus\n    '.el-aside',\n    '.el-menu:not(.el-menu--horizontal)',\n    // Arco Design\n    '.arco-layout-sider',\n    // Generic\n    'aside',\n    '[role=\"navigation\"]:not(header *)',\n    '.sidebar',\n    '.side-menu',\n    '.side-nav',\n    '.left-menu',\n    '#sidebar',\n  ],\n  contentSelectors: [\n    // Ant Design\n    '.ant-layout-content',\n    // Element Plus\n    '.el-main',\n    // Arco Design\n    '.arco-layout-content',\n    // Generic\n    'main',\n    '[role=\"main\"]',\n    '.content',\n    '.main-content',\n    '.page-content',\n    '.container:not(.ant-layout):not(.el-container)',\n    '#content',\n    '#main',\n  ],\n  footerSelectors: [\n    // Ant Design\n    '.ant-layout-footer',\n    // Element Plus\n    '.el-footer',\n    // Arco Design\n    '.arco-layout-footer',\n    // Generic\n    'footer',\n    '[role=\"contentinfo\"]',\n    '.footer',\n    '#footer',\n  ],\n  breadcrumbSelectors: [\n    '.ant-breadcrumb',\n    '.el-breadcrumb',\n    '.arco-breadcrumb',\n    '[aria-label=\"breadcrumb\"]',\n    '.breadcrumb',\n    'nav[aria-label*=\"breadcrumb\"]',\n  ],\n};\n\n/**\n * Find the best matching element for a layout region\n */\nfunction findBestElement(selectors: string[]): Element | null {\n  for (const selector of selectors) {\n    const elements = findVisibleElements(selector);\n    if (elements.length > 0) {\n      // Return the first visible element\n      return elements[0];\n    }\n  }\n  return null;\n}\n\n/**\n * Detect header region\n */\nfunction detectHeader(config: LayoutDetectionConfig): LayoutRegion | null {\n  const element = findBestElement(config.headerSelectors);\n  if (!element) return null;\n  \n  // Verify it looks like a header (typically at top, full width)\n  const box = getBoundingBox(element);\n  if (box.y > 200 || box.width < window.innerWidth * 0.5) {\n    return null;\n  }\n  \n  return {\n    type: 'header',\n    selector: getUniqueSelector(element),\n    boundingBox: box,\n  };\n}\n\n/**\n * Detect sidebar region\n */\nfunction detectSidebar(config: LayoutDetectionConfig): LayoutRegion | null {\n  const element = findBestElement(config.sidebarSelectors);\n  if (!element) return null;\n  \n  // Verify it looks like a sidebar (tall and narrow, on left or right)\n  const box = getBoundingBox(element);\n  const isNarrow = box.width < window.innerWidth * 0.4;\n  const isTall = box.height > window.innerHeight * 0.5;\n  \n  if (!isNarrow || !isTall) {\n    return null;\n  }\n  \n  return {\n    type: 'sidebar',\n    selector: getUniqueSelector(element),\n    boundingBox: box,\n  };\n}\n\n/**\n * Detect content region\n */\nfunction detectContent(config: LayoutDetectionConfig): LayoutRegion | null {\n  const element = findBestElement(config.contentSelectors);\n  if (!element) return null;\n  \n  return {\n    type: 'content',\n    selector: getUniqueSelector(element),\n    boundingBox: getBoundingBox(element),\n  };\n}\n\n/**\n * Detect footer region\n */\nfunction detectFooter(config: LayoutDetectionConfig): LayoutRegion | null {\n  const element = findBestElement(config.footerSelectors);\n  if (!element) return null;\n  \n  // Verify it looks like a footer (typically at bottom)\n  const box = getBoundingBox(element);\n  const viewportHeight = window.innerHeight;\n  \n  // Footer should be near bottom or have fixed/sticky position\n  if (box.y < viewportHeight * 0.5 && !isFixedOrSticky(element)) {\n    return null;\n  }\n  \n  return {\n    type: 'footer',\n    selector: getUniqueSelector(element),\n    boundingBox: box,\n  };\n}\n\n/**\n * Detect breadcrumb region\n */\nfunction detectBreadcrumb(config: LayoutDetectionConfig): LayoutRegion | null {\n  const element = findBestElement(config.breadcrumbSelectors);\n  if (!element) return null;\n  \n  return {\n    type: 'breadcrumb',\n    selector: getUniqueSelector(element),\n    boundingBox: getBoundingBox(element),\n  };\n}\n\n/**\n * Analyze page layout\n */\nexport function analyzePageLayout(\n  customConfig?: Partial<LayoutDetectionConfig>\n): LayoutInfo {\n  const config: LayoutDetectionConfig = {\n    ...DEFAULT_LAYOUT_CONFIG,\n    ...customConfig,\n  };\n  \n  const regions: LayoutRegion[] = [];\n  \n  // Detect each region\n  const header = detectHeader(config);\n  const sidebar = detectSidebar(config);\n  const content = detectContent(config);\n  const footer = detectFooter(config);\n  const breadcrumb = detectBreadcrumb(config);\n  \n  if (header) regions.push(header);\n  if (sidebar) regions.push(sidebar);\n  if (content) regions.push(content);\n  if (footer) regions.push(footer);\n  if (breadcrumb) regions.push(breadcrumb);\n  \n  // Calculate sidebar position\n  let sidebarPosition: 'left' | 'right' | undefined;\n  let sidebarWidth: number | undefined;\n  \n  if (sidebar) {\n    sidebarWidth = sidebar.boundingBox.width;\n    sidebarPosition = sidebar.boundingBox.x < window.innerWidth / 2 ? 'left' : 'right';\n  }\n  \n  // Calculate header height\n  const headerHeight = header?.boundingBox.height;\n  \n  return {\n    hasHeader: header !== null,\n    hasSidebar: sidebar !== null,\n    hasFooter: footer !== null,\n    sidebarPosition,\n    sidebarWidth,\n    headerHeight,\n    regions,\n  };\n}\n\n/**\n * Get layout type classification\n */\nexport function classifyLayout(layoutInfo: LayoutInfo): string {\n  const { hasHeader, hasSidebar, hasFooter, sidebarPosition } = layoutInfo;\n  \n  if (hasHeader && hasSidebar && sidebarPosition === 'left') {\n    return 'admin-layout'; // Classic admin layout\n  }\n  \n  if (hasHeader && !hasSidebar) {\n    return 'top-nav-layout'; // Top navigation layout\n  }\n  \n  if (!hasHeader && hasSidebar) {\n    return 'side-only-layout'; // Side navigation only\n  }\n  \n  if (hasHeader && hasSidebar && hasFooter) {\n    return 'full-layout'; // Full layout with all regions\n  }\n  \n  return 'basic-layout'; // Basic layout\n}\n\n/**\n * Detect if page has multiple content areas (like cards/panels)\n */\nexport function detectContentAreas(contentRegion?: LayoutRegion): Element[] {\n  if (!contentRegion) {\n    return [];\n  }\n  \n  const container = document.querySelector(contentRegion.selector);\n  if (!container) {\n    return [];\n  }\n  \n  // Find cards or panels within content\n  const areas = container.querySelectorAll(\n    '.ant-card, .el-card, .arco-card, ' +\n    '.ant-collapse, .el-collapse, .arco-collapse, ' +\n    '.panel, .section'\n  );\n  \n  return Array.from(areas).filter(el => isElementVisible(el));\n}\n\n/**\n * Get recommended layout component for code generation\n */\nexport function getRecommendedLayoutComponent(layoutInfo: LayoutInfo): string {\n  const layoutType = classifyLayout(layoutInfo);\n  \n  switch (layoutType) {\n    case 'admin-layout':\n      return 'ProLayout'; // Ant Design Pro Layout\n    case 'top-nav-layout':\n      return 'BasicLayout';\n    case 'side-only-layout':\n      return 'SiderLayout';\n    case 'full-layout':\n      return 'FullLayout';\n    default:\n      return 'Layout';\n  }\n}\n","/**\n * Menu Analyzer - Analyze and extract menu structure from admin panels\n * \n * Supports common menu patterns:\n * - Ant Design Menu/Sider\n * - Element UI NavMenu\n * - Custom sidebar menus\n * - Horizontal navigation menus\n */\n\nimport type { MenuItem, Menu, MenuConfig } from '@core/types/menu';\nimport { generateSelector } from '@core/utils/dom-utils';\n\n// Common menu selectors for different UI frameworks\nconst MENU_SELECTORS = {\n  // Ant Design\n  antdMenu: '.ant-menu',\n  antdMenuItem: '.ant-menu-item',\n  antdSubMenu: '.ant-menu-submenu',\n  antdSubMenuTitle: '.ant-menu-submenu-title',\n  antdMenuItemGroup: '.ant-menu-item-group',\n  \n  // Element UI\n  elementMenu: '.el-menu',\n  elementMenuItem: '.el-menu-item',\n  elementSubMenu: '.el-submenu',\n  \n  // Common patterns\n  sidebar: '[class*=\"sidebar\"], [class*=\"sider\"], [class*=\"side-menu\"], aside',\n  nav: 'nav, [class*=\"nav-menu\"], [class*=\"navigation\"]',\n  menuItem: '[class*=\"menu-item\"], [class*=\"nav-item\"], li[role=\"menuitem\"]',\n  \n  // Link patterns\n  link: 'a[href]',\n  routerLink: '[class*=\"router-link\"], [data-route]',\n};\n\n// Icon class patterns to identify icon types\nconst ICON_CLASS_PATTERNS: Record<string, RegExp[]> = {\n  dashboard: [/dashboard/i, /home/i, /index/i, /overview/i],\n  user: [/user/i, /person/i, /account/i, /profile/i, /member/i],\n  setting: [/setting/i, /config/i, /preference/i, /gear/i, /cog/i],\n  table: [/table/i, /list/i, /grid/i, /data/i],\n  form: [/form/i, /edit/i, /write/i, /input/i],\n  chart: [/chart/i, /graph/i, /statistic/i, /analytics/i],\n  file: [/file/i, /document/i, /folder/i, /attachment/i],\n  message: [/message/i, /mail/i, /notification/i, /bell/i, /comment/i],\n  shop: [/shop/i, /cart/i, /order/i, /product/i, /goods/i],\n  money: [/money/i, /finance/i, /payment/i, /wallet/i, /dollar/i],\n  team: [/team/i, /group/i, /organization/i, /department/i],\n  calendar: [/calendar/i, /date/i, /schedule/i, /event/i],\n  search: [/search/i, /find/i, /query/i],\n  lock: [/lock/i, /security/i, /permission/i, /auth/i],\n  api: [/api/i, /interface/i, /endpoint/i],\n  database: [/database/i, /db/i, /storage/i],\n  cloud: [/cloud/i, /upload/i, /download/i],\n  tool: [/tool/i, /utility/i, /wrench/i],\n};\n\n/**\n * Extract icon type from element's icon classes\n */\nfunction extractIconType(element: Element): string | undefined {\n  // Check for icon element within the menu item\n  const iconElement = element.querySelector('[class*=\"icon\"], i, svg, .anticon');\n  if (!iconElement) return undefined;\n  \n  const className = iconElement.className || '';\n  const iconClasses = typeof className === 'string' ? className : '';\n  \n  // Check against known patterns\n  for (const [iconType, patterns] of Object.entries(ICON_CLASS_PATTERNS)) {\n    for (const pattern of patterns) {\n      if (pattern.test(iconClasses)) {\n        return iconType;\n      }\n    }\n  }\n  \n  // Extract from specific icon class formats\n  // Ant Design: anticon-xxx, .anticon-dashboard\n  const antdMatch = iconClasses.match(/anticon-(\\w+)/);\n  if (antdMatch) return antdMatch[1];\n  \n  // FontAwesome: fa-xxx\n  const faMatch = iconClasses.match(/fa-(\\w+)/);\n  if (faMatch) return faMatch[1];\n  \n  // Element UI: el-icon-xxx\n  const elMatch = iconClasses.match(/el-icon-(\\w+)/);\n  if (elMatch) return elMatch[1];\n  \n  // iconfont: icon-xxx\n  const iconfontMatch = iconClasses.match(/icon-(\\w+)/);\n  if (iconfontMatch) return iconfontMatch[1];\n  \n  return undefined;\n}\n\n/**\n * Extract href/path from menu item\n */\nfunction extractPath(element: Element): string | undefined {\n  // Direct link\n  if (element.tagName === 'A') {\n    return element.getAttribute('href') || undefined;\n  }\n  \n  // Child link\n  const link = element.querySelector('a[href]');\n  if (link) {\n    return link.getAttribute('href') || undefined;\n  }\n  \n  // Data attributes\n  const dataPath = element.getAttribute('data-path') || \n                   element.getAttribute('data-route') ||\n                   element.getAttribute('data-href');\n  if (dataPath) return dataPath;\n  \n  // Click handler with route (heuristic)\n  const onClick = element.getAttribute('onclick') || '';\n  const routeMatch = onClick.match(/['\"]([/\\w-]+)['\"]/);\n  if (routeMatch) return routeMatch[1];\n  \n  return undefined;\n}\n\n/**\n * Extract menu item title text\n */\nfunction extractTitle(element: Element): string {\n  // Try specific title elements first\n  const titleElement = element.querySelector(\n    '.ant-menu-title-content, .menu-title, .nav-text, [class*=\"title\"], span:not([class*=\"icon\"])'\n  );\n  \n  if (titleElement) {\n    return titleElement.textContent?.trim() || '';\n  }\n  \n  // Get direct text content (excluding child elements)\n  const clone = element.cloneNode(true) as Element;\n  // Remove icon elements\n  clone.querySelectorAll('[class*=\"icon\"], i, svg, .anticon').forEach(el => el.remove());\n  // Remove badges/counts\n  clone.querySelectorAll('[class*=\"badge\"], [class*=\"count\"], sup').forEach(el => el.remove());\n  \n  return clone.textContent?.trim() || '';\n}\n\n/**\n * Check if element is a submenu container\n */\nfunction isSubMenu(element: Element): boolean {\n  // Check for common submenu patterns\n  if (element.matches(MENU_SELECTORS.antdSubMenu) ||\n      element.matches(MENU_SELECTORS.elementSubMenu)) {\n    return true;\n  }\n  \n  // Check for submenu indicators in class names\n  const className = element.className || '';\n  if (/submenu|sub-menu|has-child|has-submenu|expandable/i.test(className)) {\n    return true;\n  }\n  \n  // Check for nested list\n  const nestedList = element.querySelector(':scope > ul, :scope > ol, :scope > div > ul');\n  if (nestedList && nestedList.children.length > 0) {\n    return true;\n  }\n  \n  // Check for Ant Design submenu structure\n  const antdSub = element.querySelector('.ant-menu-sub, .ant-menu-inline');\n  if (antdSub) {\n    return true;\n  }\n  \n  // Check for expand/collapse icon indicating children\n  const expandIcon = element.querySelector('[class*=\"expand\"], [class*=\"arrow\"], [class*=\"caret\"], .ant-menu-submenu-arrow');\n  if (expandIcon) {\n    return true;\n  }\n  \n  return false;\n}\n\n/**\n * Find child menu container within a submenu element\n */\nfunction findChildContainer(element: Element): Element | null {\n  // Try specific submenu containers\n  const selectors = [\n    '.ant-menu-sub',\n    '.ant-menu-inline', \n    '.el-menu',\n    '[class*=\"submenu-content\"]',\n    '[class*=\"sub-menu\"]',\n    ':scope > ul',\n    ':scope > ol',\n    ':scope > div > ul',\n  ];\n  \n  for (const selector of selectors) {\n    const container = element.querySelector(selector);\n    if (container && container.children.length > 0) {\n      return container;\n    }\n  }\n  \n  return null;\n}\n\n/**\n * Get direct child menu items from a container\n */\nfunction getDirectChildMenuItems(container: Element): Element[] {\n  // For Ant Design menu, get all direct menu items and submenus\n  const antdItems = container.querySelectorAll(':scope > .ant-menu-item, :scope > .ant-menu-submenu, :scope > .ant-menu-item-group');\n  if (antdItems.length > 0) {\n    return Array.from(antdItems);\n  }\n  \n  // For Element UI menu\n  const elItems = container.querySelectorAll(':scope > .el-menu-item, :scope > .el-submenu');\n  if (elItems.length > 0) {\n    return Array.from(elItems);\n  }\n  \n  // Generic: all direct li children\n  const liItems = container.querySelectorAll(':scope > li');\n  if (liItems.length > 0) {\n    return Array.from(liItems);\n  }\n  \n  // Fallback: direct children that look like menu items\n  return Array.from(container.children).filter(child => {\n    const tagName = child.tagName.toLowerCase();\n    if (tagName === 'style' || tagName === 'script' || tagName === 'svg') return false;\n    \n    const className = child.className || '';\n    const hasText = child.textContent?.trim();\n    const isMenuLike = /menu|nav|item/i.test(className);\n    \n    return hasText && (tagName === 'li' || tagName === 'a' || isMenuLike);\n  });\n}\n\n/**\n * Parse a single menu item element\n */\nfunction parseMenuItem(element: Element, level: number = 0, parentId?: string): MenuItem | null {\n  // For submenu, get title from the submenu title element\n  let titleElement = element;\n  if (element.matches(MENU_SELECTORS.antdSubMenu) || element.matches(MENU_SELECTORS.elementSubMenu)) {\n    const submenuTitle = element.querySelector('.ant-menu-submenu-title, .el-submenu__title, [class*=\"submenu-title\"]');\n    if (submenuTitle) {\n      titleElement = submenuTitle;\n    }\n  }\n  \n  const title = extractTitle(titleElement);\n  if (!title) return null;\n  \n  const id = `menu-${Date.now()}-${Math.random().toString(36).substring(2, 7)}`;\n  const path = extractPath(element);\n  const iconType = extractIconType(titleElement);\n  const isActive = element.classList.contains('ant-menu-item-selected') ||\n                   element.classList.contains('ant-menu-submenu-selected') ||\n                   element.classList.contains('ant-menu-submenu-open') ||\n                   element.classList.contains('active') ||\n                   element.classList.contains('is-active') ||\n                   element.getAttribute('aria-selected') === 'true';\n  \n  const menuItem: MenuItem = {\n    id,\n    title,\n    path,\n    icon: iconType,\n    level,\n    parentId,\n    isActive,\n    sourceSelector: generateSelector(element),\n  };\n  \n  // Check for children (submenu)\n  if (isSubMenu(element)) {\n    const childContainer = findChildContainer(element);\n    \n    if (childContainer) {\n      const childElements = getDirectChildMenuItems(childContainer);\n      \n      const children: MenuItem[] = [];\n      childElements.forEach(childEl => {\n        // Skip dividers and separators\n        if (childEl.classList.contains('ant-menu-item-divider') ||\n            childEl.classList.contains('divider') ||\n            childEl.classList.contains('separator')) {\n          return;\n        }\n        \n        const child = parseMenuItem(childEl, level + 1, id);\n        if (child) children.push(child);\n      });\n      \n      if (children.length > 0) {\n        menuItem.children = children;\n      }\n    }\n  }\n  \n  return menuItem;\n}\n\n/**\n * Find menu container element\n */\nfunction findMenuContainer(): Element | null {\n  // Try to find the main sidebar menu first\n  const siderMenu = document.querySelector('.ant-layout-sider .ant-menu');\n  if (siderMenu && siderMenu.children.length > 0) {\n    console.log('[Menu Analyzer] Found sider menu');\n    return siderMenu;\n  }\n  \n  // Try common sidebar selectors\n  const sidebarSelectors = [\n    '[class*=\"sidebar\"] .ant-menu',\n    '[class*=\"sider\"] .ant-menu', \n    'aside .ant-menu',\n    '.ant-menu-inline',\n    '.ant-menu-vertical',\n  ];\n  \n  for (const selector of sidebarSelectors) {\n    const menu = document.querySelector(selector);\n    if (menu && menu.children.length > 2) {\n      console.log('[Menu Analyzer] Found menu with selector:', selector);\n      return menu;\n    }\n  }\n  \n  // Try to find the largest ant-menu (likely the main navigation)\n  const allAntMenus = document.querySelectorAll('.ant-menu:not(.ant-menu-sub):not(.ant-menu-submenu-popup)');\n  let bestMenu: Element | null = null;\n  let maxItems = 0;\n  \n  allAntMenus.forEach(menu => {\n    const itemCount = menu.querySelectorAll('.ant-menu-item, .ant-menu-submenu').length;\n    if (itemCount > maxItems) {\n      maxItems = itemCount;\n      bestMenu = menu;\n    }\n  });\n  \n  if (bestMenu && maxItems > 2) {\n    console.log('[Menu Analyzer] Found best ant-menu with', maxItems, 'items');\n    return bestMenu;\n  }\n  \n  // Element UI fallback\n  const elMenu = document.querySelector('.el-menu:not(.el-menu--popup)');\n  if (elMenu && elMenu.children.length > 0) {\n    console.log('[Menu Analyzer] Found Element UI menu');\n    return elMenu;\n  }\n  \n  // Generic sidebar fallback\n  const sidebar = document.querySelector('[class*=\"sidebar\"], [class*=\"sider\"], aside');\n  if (sidebar) {\n    const menuInSidebar = sidebar.querySelector('ul, nav, [class*=\"menu\"]');\n    if (menuInSidebar && menuInSidebar.children.length > 0) {\n      console.log('[Menu Analyzer] Found menu in sidebar');\n      return menuInSidebar;\n    }\n  }\n  \n  return null;\n}\n\n/**\n * Detect menu type (vertical sidebar vs horizontal nav)\n */\nfunction detectMenuType(container: Element): 'sidebar' | 'horizontal' | 'inline' {\n  const computedStyle = window.getComputedStyle(container);\n  const isHorizontal = computedStyle.flexDirection === 'row' ||\n                       container.classList.contains('ant-menu-horizontal') ||\n                       container.classList.contains('el-menu--horizontal');\n  \n  if (isHorizontal) return 'horizontal';\n  \n  const isInline = container.classList.contains('ant-menu-inline') ||\n                   container.classList.contains('ant-menu-vertical') ||\n                   container.closest('.ant-layout-sider');\n  \n  return isInline ? 'sidebar' : 'inline';\n}\n\n/**\n * Analyze the page menu structure\n */\nexport function analyzeMenu(): Menu | null {\n  const menuContainer = findMenuContainer();\n  \n  if (!menuContainer) {\n    console.log('[Menu Analyzer] No menu container found');\n    return null;\n  }\n  \n  console.log('[Menu Analyzer] Analyzing menu container:', menuContainer.className);\n  \n  const menuType = detectMenuType(menuContainer);\n  const items: MenuItem[] = [];\n  \n  // Get top-level menu items - look for direct children that are menu items\n  const topLevelElements = getDirectChildMenuItems(menuContainer);\n  \n  console.log('[Menu Analyzer] Found top-level elements:', topLevelElements.length);\n  \n  topLevelElements.forEach((element, index) => {\n    // Skip non-menu items\n    if (element.classList.contains('ant-menu-item-divider') ||\n        element.classList.contains('divider')) {\n      return;\n    }\n    \n    // Log for debugging\n    const text = element.textContent?.trim().substring(0, 30);\n    console.log(`[Menu Analyzer] Processing item ${index}: \"${text}\"`, element.className);\n    \n    const menuItem = parseMenuItem(element, 0);\n    if (menuItem) {\n      items.push(menuItem);\n      console.log(`[Menu Analyzer] Parsed: \"${menuItem.title}\", children: ${menuItem.children?.length || 0}`);\n    }\n  });\n  \n  if (items.length === 0) {\n    console.log('[Menu Analyzer] No menu items found');\n    return null;\n  }\n  \n  // Build menu object\n  const menu: Menu = {\n    id: `menu-${Date.now()}`,\n    items,\n    type: menuType,\n    sourceSelector: generateSelector(menuContainer),\n    analyzedAt: Date.now(),\n  };\n  \n  const totalItems = countAllItems(items);\n  console.log('[Menu Analyzer] Menu analysis complete:', {\n    type: menuType,\n    topLevelCount: items.length,\n    totalItems: totalItems,\n  });\n  \n  return menu;\n}\n\n/**\n * Count total menu items including nested children\n */\nfunction countAllItems(items: MenuItem[]): number {\n  let count = items.length;\n  for (const item of items) {\n    if (item.children) {\n      count += countAllItems(item.children);\n    }\n  }\n  return count;\n}\n\n/**\n * Get menu configuration for code generation\n */\nexport function getMenuConfig(menu: Menu): MenuConfig {\n  return {\n    mode: menu.type === 'horizontal' ? 'horizontal' : 'inline',\n    theme: detectMenuTheme(),\n    collapsed: isMenuCollapsed(),\n    items: menu.items,\n  };\n}\n\n/**\n * Detect menu theme (light/dark)\n */\nfunction detectMenuTheme(): 'light' | 'dark' {\n  const menuContainer = findMenuContainer();\n  if (!menuContainer) return 'light';\n  \n  // Check for dark theme classes\n  if (menuContainer.classList.contains('ant-menu-dark') ||\n      menuContainer.closest('.ant-layout-sider-dark')) {\n    return 'dark';\n  }\n  \n  // Check background color\n  const bgColor = window.getComputedStyle(menuContainer).backgroundColor;\n  if (bgColor) {\n    // Parse RGB values\n    const match = bgColor.match(/\\d+/g);\n    if (match && match.length >= 3) {\n      const [r, g, b] = match.map(Number);\n      // Dark if average brightness is low\n      const brightness = (r + g + b) / 3;\n      if (brightness < 100) return 'dark';\n    }\n  }\n  \n  return 'light';\n}\n\n/**\n * Check if menu is collapsed\n */\nfunction isMenuCollapsed(): boolean {\n  const sider = document.querySelector('.ant-layout-sider');\n  if (sider) {\n    return sider.classList.contains('ant-layout-sider-collapsed');\n  }\n  \n  const menuContainer = findMenuContainer();\n  if (menuContainer) {\n    return menuContainer.classList.contains('ant-menu-inline-collapsed') ||\n           menuContainer.classList.contains('collapsed');\n  }\n  \n  return false;\n}\n\n/**\n * Find active menu item\n */\nexport function findActiveMenuItem(): MenuItem | null {\n  const menu = analyzeMenu();\n  if (!menu) return null;\n  \n  function findActive(items: MenuItem[]): MenuItem | null {\n    for (const item of items) {\n      if (item.isActive) return item;\n      if (item.children) {\n        const active = findActive(item.children);\n        if (active) return active;\n      }\n    }\n    return null;\n  }\n  \n  return findActive(menu.items);\n}\n\n/**\n * Get all navigable menu items (with paths)\n */\nexport function getNavigableItems(menu: Menu): MenuItem[] {\n  const navigable: MenuItem[] = [];\n  \n  function collect(items: MenuItem[]) {\n    for (const item of items) {\n      if (item.path && !item.path.startsWith('#') && !item.path.startsWith('javascript:')) {\n        navigable.push(item);\n      }\n      if (item.children) {\n        collect(item.children);\n      }\n    }\n  }\n  \n  collect(menu.items);\n  return navigable;\n}\n","/**\n * Load Detector - Detect when a page has fully loaded after navigation\n * \n * Uses multiple signals:\n * - URL change detection\n * - DOM stability (MutationObserver)\n * - Network idle detection\n * - Specific element appearance\n */\n\nexport interface LoadDetectorOptions {\n  /** Timeout in milliseconds before giving up */\n  timeout?: number;\n  /** Minimum time to wait for DOM to stabilize */\n  stabilityDelay?: number;\n  /** Selector for element that indicates page is ready */\n  readySelector?: string;\n  /** Check interval for stability */\n  checkInterval?: number;\n}\n\nconst DEFAULT_OPTIONS: Required<LoadDetectorOptions> = {\n  timeout: 30000, // 30 seconds\n  stabilityDelay: 500, // 500ms of no DOM changes\n  readySelector: '',\n  checkInterval: 100,\n};\n\n/**\n * Wait for DOM to become stable (no mutations for a period)\n */\nexport function waitForDomStability(options: LoadDetectorOptions = {}): Promise<void> {\n  const opts = { ...DEFAULT_OPTIONS, ...options };\n  \n  return new Promise((resolve, reject) => {\n    let lastMutationTime = Date.now();\n    let checkTimer: ReturnType<typeof setInterval>;\n    let timeoutTimer: ReturnType<typeof setTimeout>;\n    \n    const observer = new MutationObserver(() => {\n      lastMutationTime = Date.now();\n    });\n    \n    // Observe the entire document\n    observer.observe(document.body, {\n      childList: true,\n      subtree: true,\n      attributes: true,\n      characterData: true,\n    });\n    \n    // Check periodically if DOM has been stable\n    checkTimer = setInterval(() => {\n      const timeSinceLastMutation = Date.now() - lastMutationTime;\n      if (timeSinceLastMutation >= opts.stabilityDelay) {\n        cleanup();\n        resolve();\n      }\n    }, opts.checkInterval);\n    \n    // Timeout\n    timeoutTimer = setTimeout(() => {\n      cleanup();\n      reject(new Error(`DOM stability timeout after ${opts.timeout}ms`));\n    }, opts.timeout);\n    \n    function cleanup() {\n      observer.disconnect();\n      clearInterval(checkTimer);\n      clearTimeout(timeoutTimer);\n    }\n  });\n}\n\n/**\n * Wait for a specific element to appear in DOM\n */\nexport function waitForElement(\n  selector: string,\n  options: LoadDetectorOptions = {}\n): Promise<Element> {\n  const opts = { ...DEFAULT_OPTIONS, ...options };\n  \n  return new Promise((resolve, reject) => {\n    // Check if already present\n    const existing = document.querySelector(selector);\n    if (existing) {\n      resolve(existing);\n      return;\n    }\n    \n    let timeoutTimer: ReturnType<typeof setTimeout>;\n    \n    const observer = new MutationObserver(() => {\n      const element = document.querySelector(selector);\n      if (element) {\n        cleanup();\n        resolve(element);\n      }\n    });\n    \n    observer.observe(document.body, {\n      childList: true,\n      subtree: true,\n    });\n    \n    timeoutTimer = setTimeout(() => {\n      cleanup();\n      reject(new Error(`Element \"${selector}\" not found after ${opts.timeout}ms`));\n    }, opts.timeout);\n    \n    function cleanup() {\n      observer.disconnect();\n      clearTimeout(timeoutTimer);\n    }\n  });\n}\n\n/**\n * Wait for URL to change\n */\nexport function waitForUrlChange(\n  currentUrl: string,\n  options: LoadDetectorOptions = {}\n): Promise<string> {\n  const opts = { ...DEFAULT_OPTIONS, ...options };\n  \n  return new Promise((resolve, reject) => {\n    let checkTimer: ReturnType<typeof setInterval>;\n    let timeoutTimer: ReturnType<typeof setTimeout>;\n    \n    checkTimer = setInterval(() => {\n      const newUrl = window.location.href;\n      if (newUrl !== currentUrl) {\n        cleanup();\n        resolve(newUrl);\n      }\n    }, opts.checkInterval);\n    \n    timeoutTimer = setTimeout(() => {\n      cleanup();\n      reject(new Error(`URL did not change from \"${currentUrl}\" after ${opts.timeout}ms`));\n    }, opts.timeout);\n    \n    function cleanup() {\n      clearInterval(checkTimer);\n      clearTimeout(timeoutTimer);\n    }\n  });\n}\n\n/**\n * Wait for page to be fully loaded after navigation\n * Combines URL change + DOM stability\n */\nexport async function waitForPageLoad(\n  options: LoadDetectorOptions = {}\n): Promise<void> {\n  const opts = { ...DEFAULT_OPTIONS, ...options };\n  \n  // Wait for document ready state\n  if (document.readyState !== 'complete') {\n    await new Promise<void>(resolve => {\n      const handler = () => {\n        if (document.readyState === 'complete') {\n          window.removeEventListener('load', handler);\n          resolve();\n        }\n      };\n      window.addEventListener('load', handler);\n    });\n  }\n  \n  // Wait for DOM to stabilize\n  await waitForDomStability({\n    ...opts,\n    timeout: Math.min(opts.timeout, 10000), // Max 10s for stability\n  });\n  \n  // Optionally wait for specific element\n  if (opts.readySelector) {\n    await waitForElement(opts.readySelector, opts);\n  }\n}\n\n/**\n * Detect if page is a SPA (Single Page Application)\n */\nexport function detectSpaFramework(): {\n  isSpa: boolean;\n  framework?: 'react' | 'vue' | 'angular' | 'unknown';\n} {\n  // Check for React\n  if ((window as any).__REACT_DEVTOOLS_GLOBAL_HOOK__ || \n      document.querySelector('[data-reactroot]') ||\n      document.querySelector('#root[data-v]')) {\n    return { isSpa: true, framework: 'react' };\n  }\n  \n  // Check for Vue\n  if ((window as any).__VUE__ || \n      (window as any).__VUE_DEVTOOLS_GLOBAL_HOOK__ ||\n      document.querySelector('[data-v-]')) {\n    return { isSpa: true, framework: 'vue' };\n  }\n  \n  // Check for Angular\n  if ((window as any).ng || \n      document.querySelector('[ng-version]') ||\n      document.querySelector('app-root')) {\n    return { isSpa: true, framework: 'angular' };\n  }\n  \n  // Check for common SPA patterns\n  const hasHistoryApi = typeof window.history.pushState === 'function';\n  const hasHashRouting = window.location.hash.includes('/');\n  const hasRouterOutlet = document.querySelector('router-outlet, [router-outlet]');\n  \n  if (hasRouterOutlet || hasHashRouting) {\n    return { isSpa: true, framework: 'unknown' };\n  }\n  \n  return { isSpa: hasHistoryApi, framework: undefined };\n}\n\n/**\n * Create a page load promise with timeout\n */\nexport function createLoadPromise(\n  options: LoadDetectorOptions = {}\n): {\n  promise: Promise<void>;\n  cancel: () => void;\n} {\n  const opts = { ...DEFAULT_OPTIONS, ...options };\n  let cancelled = false;\n  let rejectFn: (reason?: any) => void;\n  \n  const promise = new Promise<void>((resolve, reject) => {\n    rejectFn = reject;\n    \n    if (cancelled) {\n      reject(new Error('Load detection cancelled'));\n      return;\n    }\n    \n    waitForPageLoad(opts)\n      .then(() => {\n        if (!cancelled) resolve();\n      })\n      .catch(error => {\n        if (!cancelled) reject(error);\n      });\n  });\n  \n  return {\n    promise,\n    cancel: () => {\n      cancelled = true;\n      rejectFn?.(new Error('Load detection cancelled'));\n    },\n  };\n}\n\nexport default {\n  waitForDomStability,\n  waitForElement,\n  waitForUrlChange,\n  waitForPageLoad,\n  detectSpaFramework,\n  createLoadPromise,\n};\n","/**\n * Navigation Controller - Handle menu item clicks and navigation\n * \n * Supports:\n * - Direct link clicks\n * - SPA route navigation\n * - Hash-based routing\n * - Programmatic navigation via onclick handlers\n */\n\nimport type { MenuItem } from '@core/types/menu';\nimport { waitForUrlChange, waitForDomStability } from './load-detector';\n\nexport interface NavigationOptions {\n  /** Timeout for navigation in ms */\n  timeout?: number;\n  /** Delay before clicking next item */\n  clickDelay?: number;\n  /** Whether to wait for URL change */\n  waitForUrlChange?: boolean;\n  /** Whether to scroll element into view */\n  scrollIntoView?: boolean;\n}\n\nexport interface NavigationResult {\n  success: boolean;\n  url: string;\n  error?: string;\n  duration: number;\n}\n\nconst DEFAULT_OPTIONS: Required<NavigationOptions> = {\n  timeout: 30000,\n  clickDelay: 500,\n  waitForUrlChange: true,\n  scrollIntoView: true,\n};\n\n/**\n * Find the clickable element for a menu item\n */\nfunction findClickableElement(menuItem: MenuItem): Element | null {\n  // Try the source selector first\n  if (menuItem.sourceSelector) {\n    const element = document.querySelector(menuItem.sourceSelector);\n    if (element) return element;\n  }\n  \n  // Try to find by path\n  if (menuItem.path) {\n    const link = document.querySelector(`a[href=\"${menuItem.path}\"]`);\n    if (link) return link;\n    \n    // Try partial match\n    const partialLink = document.querySelector(`a[href*=\"${menuItem.path}\"]`);\n    if (partialLink) return partialLink;\n  }\n  \n  // Try to find by title text\n  if (menuItem.title) {\n    const allMenuItems = document.querySelectorAll(\n      '.ant-menu-item, .ant-menu-submenu-title, [class*=\"menu-item\"], li a'\n    );\n    \n    for (const item of allMenuItems) {\n      if (item.textContent?.trim().includes(menuItem.title)) {\n        return item;\n      }\n    }\n  }\n  \n  return null;\n}\n\n/**\n * Check if element is visible and clickable\n */\nfunction isElementClickable(element: Element): boolean {\n  const rect = element.getBoundingClientRect();\n  \n  // Check if visible\n  if (rect.width === 0 || rect.height === 0) return false;\n  \n  // Check if in viewport\n  if (rect.top < 0 || rect.left < 0) return false;\n  if (rect.bottom > window.innerHeight || rect.right > window.innerWidth) {\n    // Element is outside viewport but might be scrollable\n  }\n  \n  // Check computed style\n  const style = window.getComputedStyle(element);\n  if (style.display === 'none' || style.visibility === 'hidden') return false;\n  if (parseFloat(style.opacity) === 0) return false;\n  \n  return true;\n}\n\n/**\n * Expand parent submenus if collapsed\n */\nasync function expandParentMenus(element: Element): Promise<void> {\n  // Find parent submenu containers\n  let parent = element.parentElement;\n  const submenusToExpand: Element[] = [];\n  \n  while (parent) {\n    // Ant Design submenu\n    if (parent.classList.contains('ant-menu-submenu')) {\n      const isCollapsed = !parent.classList.contains('ant-menu-submenu-open');\n      if (isCollapsed) {\n        const title = parent.querySelector('.ant-menu-submenu-title');\n        if (title) submenusToExpand.unshift(title);\n      }\n    }\n    \n    // Element UI submenu\n    if (parent.classList.contains('el-submenu')) {\n      const isCollapsed = !parent.classList.contains('is-opened');\n      if (isCollapsed) {\n        const title = parent.querySelector('.el-submenu__title');\n        if (title) submenusToExpand.unshift(title);\n      }\n    }\n    \n    parent = parent.parentElement;\n  }\n  \n  // Expand submenus from top to bottom\n  for (const submenuTitle of submenusToExpand) {\n    (submenuTitle as HTMLElement).click();\n    await new Promise(resolve => setTimeout(resolve, 300)); // Wait for animation\n  }\n}\n\n/**\n * Simulate a click on an element\n */\nfunction simulateClick(element: Element): void {\n  // Try native click first\n  if (element instanceof HTMLElement) {\n    element.click();\n    return;\n  }\n  \n  // Dispatch click event\n  const clickEvent = new MouseEvent('click', {\n    view: window,\n    bubbles: true,\n    cancelable: true,\n  });\n  element.dispatchEvent(clickEvent);\n}\n\n/**\n * Navigate to a menu item by clicking it\n */\nexport async function navigateToMenuItem(\n  menuItem: MenuItem,\n  options: NavigationOptions = {}\n): Promise<NavigationResult> {\n  const opts = { ...DEFAULT_OPTIONS, ...options };\n  const startTime = Date.now();\n  const startUrl = window.location.href;\n  \n  try {\n    // Find the element to click\n    const element = findClickableElement(menuItem);\n    if (!element) {\n      return {\n        success: false,\n        url: startUrl,\n        error: `Could not find clickable element for menu item: ${menuItem.title}`,\n        duration: Date.now() - startTime,\n      };\n    }\n    \n    // Expand parent menus if needed\n    await expandParentMenus(element);\n    \n    // Scroll into view if needed\n    if (opts.scrollIntoView) {\n      element.scrollIntoView({ behavior: 'smooth', block: 'center' });\n      await new Promise(resolve => setTimeout(resolve, 200));\n    }\n    \n    // Check if clickable\n    if (!isElementClickable(element)) {\n      return {\n        success: false,\n        url: startUrl,\n        error: `Element is not clickable: ${menuItem.title}`,\n        duration: Date.now() - startTime,\n      };\n    }\n    \n    // Click the element\n    simulateClick(element);\n    \n    // Wait for navigation\n    if (opts.waitForUrlChange && menuItem.path) {\n      try {\n        await Promise.race([\n          waitForUrlChange(startUrl, { timeout: opts.timeout }),\n          new Promise((_, reject) => \n            setTimeout(() => reject(new Error('Navigation timeout')), opts.timeout)\n          ),\n        ]);\n      } catch {\n        // URL might not change for same-page navigation\n        console.log('[Navigation] URL did not change, checking DOM stability');\n      }\n    }\n    \n    // Wait for page to load\n    await waitForDomStability({ stabilityDelay: 300, timeout: 5000 });\n    \n    // Add click delay\n    if (opts.clickDelay > 0) {\n      await new Promise(resolve => setTimeout(resolve, opts.clickDelay));\n    }\n    \n    return {\n      success: true,\n      url: window.location.href,\n      duration: Date.now() - startTime,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      url: window.location.href,\n      error: error instanceof Error ? error.message : 'Unknown navigation error',\n      duration: Date.now() - startTime,\n    };\n  }\n}\n\n/**\n * Navigate back to original URL\n */\nexport async function navigateBack(originalUrl: string): Promise<NavigationResult> {\n  const startTime = Date.now();\n  const currentUrl = window.location.href;\n  \n  if (currentUrl === originalUrl) {\n    return {\n      success: true,\n      url: originalUrl,\n      duration: 0,\n    };\n  }\n  \n  try {\n    // Use history API if available\n    window.history.back();\n    \n    await waitForUrlChange(currentUrl, { timeout: 5000 }).catch(() => {\n      // If history.back() didn't work, navigate directly\n      window.location.href = originalUrl;\n    });\n    \n    await waitForDomStability({ stabilityDelay: 300 });\n    \n    return {\n      success: true,\n      url: window.location.href,\n      duration: Date.now() - startTime,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      url: window.location.href,\n      error: error instanceof Error ? error.message : 'Navigation back failed',\n      duration: Date.now() - startTime,\n    };\n  }\n}\n\n/**\n * Check if current URL matches expected path\n */\nexport function urlMatchesPath(expectedPath: string): boolean {\n  const currentUrl = window.location.href;\n  const currentPath = window.location.pathname + window.location.hash;\n  \n  // Exact match\n  if (currentPath === expectedPath) return true;\n  if (currentUrl.endsWith(expectedPath)) return true;\n  \n  // Partial match (for parameterized routes)\n  const normalizedExpected = expectedPath.replace(/\\/+$/, '');\n  const normalizedCurrent = currentPath.replace(/\\/+$/, '');\n  \n  return normalizedCurrent === normalizedExpected || \n         normalizedCurrent.startsWith(normalizedExpected + '/');\n}\n\nexport default {\n  navigateToMenuItem,\n  navigateBack,\n  urlMatchesPath,\n  findClickableElement,\n  isElementClickable,\n};\n","/**\n * Interaction Controller - detects safe interactive targets (tabs / toggles / whitelisted buttons)\n * and provides helpers to trigger them during traversal.\n */\n\nimport { getUniqueSelector, getVisibleText, isElementVisible } from '@core/utils/dom-utils';\nimport type { InteractionRunResult, InteractionTarget, InteractionType } from '@core/types/interaction';\nimport { waitForDomStability } from './load-detector';\n\nconst TARGET_ATTR = 'data-admin-clone-interaction-id';\nconst MAX_TARGETS_DEFAULT = 8;\nconst DANGEROUS_KEYWORDS = ['删', '刪', '删除', '刪除', 'remove', '移除', '删除', '解散', '终止', '停止', 'stop', '禁用', 'disable', '关闭', '關閉', 'close', '退出', 'log out', 'logout', '作废', '废弃', '废除'];\n\ninterface InternalTarget extends InteractionTarget {\n  originalSelector: string;\n}\n\nconst targetCache = new Map<string, InternalTarget>();\n\nfunction clearExistingMarkers(): void {\n  document.querySelectorAll(`[${TARGET_ATTR}]`).forEach(el => el.removeAttribute(TARGET_ATTR));\n  targetCache.clear();\n}\n\nfunction isDangerousLabel(label: string): boolean {\n  const lower = label.toLowerCase();\n  return DANGEROUS_KEYWORDS.some(keyword => lower.includes(keyword.toLowerCase()));\n}\n\nfunction assignTarget(\n  element: Element,\n  type: InteractionType,\n  options: Omit<InteractionTarget, 'id' | 'type' | 'selector' | 'order'> & { order: number }\n): InteractionTarget | null {\n  if (!isElementVisible(element)) {\n    return null;\n  }\n  const label = options.label?.trim() || getVisibleText(element) || '未命名交互';\n  if (type === 'button' && isDangerousLabel(label)) {\n    return null;\n  }\n  const id = `interaction-${Date.now()}-${Math.random().toString(36).slice(2, 8)}`;\n  (element as HTMLElement).setAttribute(TARGET_ATTR, id);\n  const originalSelector = getUniqueSelector(element);\n  const selector = `[${TARGET_ATTR}=\"${id}\"]`;\n  const target: InteractionTarget = {\n    id,\n    type,\n    label,\n    group: options.group,\n    groupLabel: options.groupLabel,\n    description: options.description,\n    selector,\n    order: options.order,\n    source: options.source,\n    attributes: options.attributes,\n  };\n  targetCache.set(id, { ...target, originalSelector });\n  return target;\n}\n\nfunction findTabContainers(): Element[] {\n  const selectors = [\n    '.ant-tabs',\n    '.ant-pro-card-tabs',\n    '.el-tabs',\n    '.arco-tabs',\n    '[role=\"tablist\"]',\n  ];\n  const containers: Element[] = [];\n  selectors.forEach(selector => {\n    document.querySelectorAll(selector).forEach(container => {\n      if (isElementVisible(container) && !containers.includes(container)) {\n        containers.push(container);\n      }\n    });\n  });\n  return containers;\n}\n\nfunction collectTabs(limit: number, startOrder: number): InteractionTarget[] {\n  const results: InteractionTarget[] = [];\n  let order = startOrder;\n  for (const container of findTabContainers()) {\n    const tabItems = container.querySelectorAll(\n      '.ant-tabs-tab, .ant-tabs-tab-btn, .el-tabs__item, .arco-tabs-item, [role=\"tab\"]'\n    );\n    const group = getUniqueSelector(container);\n    const groupLabel = container.getAttribute('aria-label') || 'Tabs';\n    tabItems.forEach(tab => {\n      if (startOrder + results.length >= limit) {\n        return;\n      }\n      if (!tab || !isElementVisible(tab)) {\n        return;\n      }\n      const label = getVisibleText(tab) || 'Tab';\n      if (!label || label.length === 0) {\n        return;\n      }\n      const target = assignTarget(tab, 'tab', {\n        label,\n        group,\n        groupLabel,\n        description: '自动切换标签页视图',\n        order: order++,\n        source: 'tabs',\n      });\n      if (target) {\n        results.push(target);\n      }\n    });\n    if (startOrder + results.length >= limit) {\n      break;\n    }\n  }\n  return results;\n}\n\nconst BUTTON_ATTRIBUTE_SELECTORS = [\n  '[data-admin-clone-trigger]',\n  '[data-auto-trigger]',\n  '[data-clone-trigger]'\n];\n\nconst TOGGLE_SELECTORS = [\n  '.ant-segmented-item',\n  '.ant-radio-button-wrapper',\n  '.ant-btn-group > .ant-btn',\n  '.el-radio-button',\n];\n\nfunction getElementAttributes(element: Element): Record<string, string> | undefined {\n  if (!(element instanceof HTMLElement) || !element.dataset) {\n    return undefined;\n  }\n  const entries = Object.entries(element.dataset).filter(([, value]) => value !== undefined) as Array<[string, string]>;\n  if (entries.length === 0) {\n    return undefined;\n  }\n  return Object.fromEntries(entries);\n}\n\nfunction collectButtons(limit: number, startOrder: number): InteractionTarget[] {\n  const results: InteractionTarget[] = [];\n  let order = startOrder;\n  const addElement = (element: Element, source: string) => {\n    if (startOrder + results.length >= limit) {\n      return;\n    }\n    const target = assignTarget(element, 'button', {\n      label: getVisibleText(element) || 'Button',\n      group: undefined,\n      groupLabel: undefined,\n      description: '自动触发按钮/开关后的页面',\n      order: order++,\n      source,\n      attributes: getElementAttributes(element),\n    });\n    if (target) {\n      results.push(target);\n    }\n  };\n  BUTTON_ATTRIBUTE_SELECTORS.forEach(selector => {\n    document.querySelectorAll(selector).forEach(element => {\n      if (startOrder + results.length >= limit) {\n        return;\n      }\n      addElement(element, 'annotation');\n    });\n  });\n  TOGGLE_SELECTORS.forEach(selector => {\n    document.querySelectorAll(selector).forEach(element => {\n      if (startOrder + results.length >= limit) {\n        return;\n      }\n      addElement(element, 'toggle');\n    });\n  });\n  return results;\n}\n\nexport function collectInteractionTargets(limit: number = MAX_TARGETS_DEFAULT): InteractionTarget[] {\n  clearExistingMarkers();\n  const results: InteractionTarget[] = [];\n  const tabTargets = collectTabs(limit, 0);\n  results.push(...tabTargets);\n  if (results.length < limit) {\n    const buttonTargets = collectButtons(limit, results.length);\n    results.push(...buttonTargets);\n  }\n  return results;\n}\n\nfunction findElementForTarget(targetId: string): Element | null {\n  const cached = targetCache.get(targetId);\n  if (!cached) {\n    return null;\n  }\n  const selectorMatch = document.querySelector(cached.selector);\n  if (selectorMatch) {\n    return selectorMatch;\n  }\n  const original = document.querySelector(cached.originalSelector);\n  if (original) {\n    (original as HTMLElement).setAttribute(TARGET_ATTR, targetId);\n    return original;\n  }\n  return null;\n}\n\nexport async function runInteractionTarget(targetId: string): Promise<InteractionRunResult> {\n  let element = findElementForTarget(targetId);\n  if (!element) {\n    return {\n      success: false,\n      targetId,\n      error: '无法找到交互元素',\n    };\n  }\n  try {\n    if (element instanceof HTMLElement) {\n      element.scrollIntoView({ behavior: 'smooth', block: 'center' });\n    }\n    await new Promise(resolve => setTimeout(resolve, 150));\n    (element as HTMLElement).click();\n    await waitForDomStability({ stabilityDelay: 400, timeout: 6000 });\n    return {\n      success: true,\n      targetId,\n    };\n  } catch (error) {\n    return {\n      success: false,\n      targetId,\n      error: error instanceof Error ? error.message : '交互触发失败',\n    };\n  }\n}\n\nexport function resetInteractionCache(): void {\n  clearExistingMarkers();\n}\n","// Admin Clone Extension - Content Script\n// This script runs in the context of web pages and handles DOM analysis\n\nimport type { Page } from '@core/types/analysis';\nimport type { RecognizedComponent } from '@core/types/component';\nimport type { AnalyzePageMessage, AnalysisResultMessage } from '@core/messaging/messages';\nimport { \n  getPageMetadata,\n} from './analyzers/dom-analyzer';\nimport { \n  analyzePageComponents, \n} from './analyzers/component-detector';\nimport { enhanceTableComponent } from './analyzers/table-analyzer';\nimport { enhanceFormComponent } from './analyzers/form-analyzer';\nimport { analyzePageLayout } from './analyzers/layout-analyzer';\nimport { analyzeMenu } from './analyzers/menu-analyzer';\nimport { navigateToMenuItem } from './traverser/navigation-controller';\nimport { waitForDomStability } from './traverser/load-detector';\nimport { collectInteractionTargets, resetInteractionCache, runInteractionTarget } from './traverser/interaction-controller';\nimport type { InteractionContext } from '@core/types/interaction';\n\nconsole.log('[Admin Clone] Content script loaded');\n\n/**\n * Generate unique page ID\n */\nfunction generatePageId(): string {\n  return `page-${Date.now()}-${Math.random().toString(36).substring(2, 9)}`;\n}\n\n/**\n * Enhance components with detailed configuration\n */\nfunction enhanceComponents(components: RecognizedComponent[]): RecognizedComponent[] {\n  return components.map(component => {\n    switch (component.type) {\n      case 'table':\n        return enhanceTableComponent(component);\n      case 'form':\n        return enhanceFormComponent(component);\n      default:\n        return component;\n    }\n  });\n}\n\n/**\n * Perform full page analysis\n */\nasync function analyzePage(sessionId?: string, interactionContext?: InteractionContext): Promise<Page> {\n  const startTime = Date.now();\n  \n  // Get page metadata\n  const metadata = getPageMetadata();\n  \n  // Analyze layout\n  const layout = analyzePageLayout();\n  \n  // Detect and analyze components\n  let components = analyzePageComponents();\n  components = enhanceComponents(components);\n  \n  // Create page object\n  const page: Page = {\n    id: generatePageId(),\n    sessionId: sessionId || '',\n    url: metadata.url,\n    title: metadata.title,\n    path: metadata.path,\n    status: 'completed',\n    layout,\n    components,\n    interactionContext,\n    analyzedAt: Date.now(),\n  };\n  \n  const duration = Date.now() - startTime;\n  console.log(`[Admin Clone] Page analysis completed in ${duration}ms`, {\n    url: page.url,\n    componentCount: components.length,\n    layout: {\n      hasHeader: layout.hasHeader,\n      hasSidebar: layout.hasSidebar,\n    }\n  });\n  \n  return page;\n}\n\n// Message handler for communication with background and popup\nchrome.runtime.onMessage.addListener((message, _sender, sendResponse) => {\n  console.log('[Admin Clone] Content script received message:', message);\n  \n  switch (message.type) {\n    case 'ANALYZE_PAGE': {\n      const analyzeMessage = message as AnalyzePageMessage;\n      \n      // Perform analysis asynchronously\n      analyzePage(analyzeMessage.sessionId, analyzeMessage.interactionContext)\n        .then(page => {\n          const response: AnalysisResultMessage = {\n            type: 'ANALYSIS_RESULT',\n            result: {\n              success: true,\n              page,\n              duration: page.analyzedAt ? Date.now() - page.analyzedAt : 0,\n            },\n          };\n          sendResponse(response);\n        })\n        .catch(error => {\n          console.error('[Admin Clone] Analysis failed:', error);\n          const response: AnalysisResultMessage = {\n            type: 'ANALYSIS_RESULT',\n            result: {\n              success: false,\n              error: error.message || 'Unknown error during analysis',\n            },\n          };\n          sendResponse(response);\n        });\n      \n      return true; // Keep channel open for async response\n    }\n    \n    case 'GET_PAGE_INFO':\n      sendResponse({\n        type: 'PAGE_INFO',\n        data: {\n          url: window.location.href,\n          title: document.title,\n          readyState: document.readyState\n        }\n      });\n      break;\n    \n    case 'ANALYZE_MENU': {\n      try {\n        const menu = analyzeMenu();\n        if (menu) {\n          sendResponse({\n            type: 'MENU_RESULT',\n            success: true,\n            menu,\n          });\n        } else {\n          sendResponse({\n            type: 'MENU_RESULT',\n            success: false,\n            error: '未找到菜单结构，请确保页面包含侧边栏或导航菜单',\n          });\n        }\n      } catch (error) {\n        console.error('[Admin Clone] Menu analysis failed:', error);\n        sendResponse({\n          type: 'MENU_RESULT',\n          success: false,\n          error: error instanceof Error ? error.message : '菜单分析失败',\n        });\n      }\n      break;\n    }\n    \n    case 'TRAVERSE_NAVIGATE': {\n      const { menuItem } = message;\n      \n      navigateToMenuItem(menuItem, {\n        timeout: 15000,\n        clickDelay: 300,\n      })\n        .then(async (result) => {\n          if (result.success) {\n            // Wait for DOM to stabilize after navigation\n            await waitForDomStability({ stabilityDelay: 500, timeout: 5000 });\n            resetInteractionCache();\n          }\n          sendResponse(result);\n        })\n        .catch(error => {\n          sendResponse({\n            success: false,\n            url: window.location.href,\n            error: error instanceof Error ? error.message : 'Navigation failed',\n            duration: 0,\n          });\n        });\n      \n      return true; // Keep channel open for async response\n    }\n    \n    case 'COLLECT_INTERACTIONS': {\n      try {\n        const limit = typeof message.limit === 'number' ? message.limit : undefined;\n        const targets = collectInteractionTargets(limit);\n        sendResponse({\n          type: 'INTERACTION_TARGETS',\n          result: {\n            success: true,\n            targets,\n          },\n        });\n      } catch (error) {\n        sendResponse({\n          type: 'INTERACTION_TARGETS',\n          result: {\n            success: false,\n            targets: [],\n            error: error instanceof Error ? error.message : 'collect interactions failed',\n          },\n        });\n      }\n      break;\n    }\n    \n    case 'RUN_INTERACTION': {\n      runInteractionTarget(message.targetId)\n        .then(result => {\n          sendResponse({\n            type: 'INTERACTION_RUN_RESULT',\n            result,\n          });\n        })\n        .catch(error => {\n          sendResponse({\n            type: 'INTERACTION_RUN_RESULT',\n            result: {\n              success: false,\n              targetId: message.targetId,\n              error: error instanceof Error ? error.message : 'interaction failed',\n            },\n          });\n        });\n      return true;\n    }\n    \n    default:\n      console.warn('[Admin Clone] Unknown message type:', message.type);\n  }\n  \n  return true;\n});\n\nexport {};\n"],"names":["LAYOUT_SELECTORS","findLayoutElement","selectors","selector","elements","findVisibleElements","getContentContainer","content","containers","largest","largestArea","container","isElementVisible","rect","area","detectUIFramework","getPageMetadata","generateComponentId","calculateConfidence","element","type","classes","getClassList","confidence","hasAntd","hasElement","hasArco","generateComponentName","index","testId","toPascalCase","id","ariaLabel","heading","text","str","word","COMPONENT_SELECTORS","detectComponents","components","processedElements","typePriority","selectorString","parent","component","createComponent","getBoundingBox","getUniqueSelector","analyzePageComponents","contentContainer","TABLE_SELECTORS","findElement","findElements","extractColumns","tableElement","columns","cell","title","getVisibleText","dataIndex","generateDataIndex","hasSorter","isFixed","style","width","commonMappings","extractPagination","tableContainer","pagination","pageSizeSelect","pageSizeText","pageSize","showSizeChanger","showTotal","extractActions","actions","firstRow","button","isDanger","isLink","analyzeTable","bordered","rowKey","enhanceTableComponent","config","FORM_SELECTORS","INPUT_TYPE_SELECTORS","detectFieldType","controlElement","generateFieldName","label","extractPlaceholder","input","extractSelectOptions","nativeSelect","opt","extractFields","formElement","fields","item","labelElement","required","name","placeholder","options","span","colElement","spanClass","c","match","detectLayout","extractLabelCol","labelAttr","firstLabel","extractButtonTexts","buttons","submitText","cancelText","analyzeForm","layout","labelCol","wrapperCol","enhanceFormComponent","isFixedOrSticky","position","DEFAULT_LAYOUT_CONFIG","findBestElement","detectHeader","box","detectSidebar","isNarrow","isTall","detectContent","detectFooter","viewportHeight","detectBreadcrumb","analyzePageLayout","customConfig","regions","header","sidebar","footer","breadcrumb","sidebarPosition","sidebarWidth","headerHeight","MENU_SELECTORS","ICON_CLASS_PATTERNS","extractIconType","iconElement","className","iconClasses","iconType","patterns","pattern","antdMatch","faMatch","elMatch","iconfontMatch","extractPath","link","dataPath","routeMatch","extractTitle","titleElement","_a","clone","el","_b","isSubMenu","nestedList","findChildContainer","getDirectChildMenuItems","antdItems","elItems","liItems","child","tagName","hasText","isMenuLike","parseMenuItem","level","parentId","submenuTitle","path","isActive","menuItem","generateSelector","childContainer","childElements","children","childEl","findMenuContainer","siderMenu","sidebarSelectors","menu","allAntMenus","bestMenu","maxItems","itemCount","elMenu","menuInSidebar","detectMenuType","analyzeMenu","menuContainer","menuType","items","topLevelElements","totalItems","countAllItems","count","DEFAULT_OPTIONS","waitForDomStability","opts","resolve","reject","lastMutationTime","checkTimer","timeoutTimer","observer","cleanup","waitForUrlChange","currentUrl","newUrl","findClickableElement","partialLink","allMenuItems","isElementClickable","expandParentMenus","submenusToExpand","simulateClick","clickEvent","navigateToMenuItem","startTime","startUrl","_","error","TARGET_ATTR","MAX_TARGETS_DEFAULT","DANGEROUS_KEYWORDS","targetCache","clearExistingMarkers","isDangerousLabel","lower","keyword","assignTarget","originalSelector","target","findTabContainers","collectTabs","limit","startOrder","results","order","tabItems","group","groupLabel","tab","BUTTON_ATTRIBUTE_SELECTORS","TOGGLE_SELECTORS","getElementAttributes","entries","value","collectButtons","addElement","source","collectInteractionTargets","tabTargets","buttonTargets","findElementForTarget","targetId","cached","selectorMatch","original","runInteractionTarget","resetInteractionCache","generatePageId","enhanceComponents","analyzePage","sessionId","interactionContext","metadata","page","duration","message","_sender","sendResponse","analyzeMessage","response","result","targets"],"mappings":"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"}