import{i as S,f as M,a as d,b as x,c as p,d as f,e as I}from"./dom-utils-DQVJ0pwT.js";const $={content:[".ant-layout-content",".el-main",".arco-layout-content","main",'[role="main"]',".content",".main-content",".page-content"]};function F(t){for(const e of t){const n=M(e);if(n.length>0)return n[0]}return null}function R(){const t=F($.content);if(t)return t;const e=document.querySelectorAll("div, section, main, article");let n=null,o=0;for(const r of e){if(!S(r))continue;const a=r.getBoundingClientRect(),i=a.width*a.height;i<1e4||i>window.innerWidth*window.innerHeight*.9||i>o&&(o=i,n=r)}return n||document.body}function B(){return document.querySelector(".ant-layout, .ant-btn, .ant-table")?"antd":document.querySelector(".el-container, .el-button, .el-table")?"element":document.querySelector(".arco-layout, .arco-btn, .arco-table")?"arco":"unknown"}function H(){return{url:window.location.href,title:document.title,path:window.location.pathname,framework:B()}}function G(){return`comp-${Date.now()}-${Math.random().toString(36).substring(2,9)}`}function W(t,e){if(e==="unknown")return .1;const n=x(t);let o=.5;const r=n.some(c=>c.startsWith("ant-")),a=n.some(c=>c.startsWith("el-")),i=n.some(c=>c.startsWith("arco-"));return(r||a||i)&&(o=.9),t.getAttribute("role")&&(o+=.1),(t.hasAttribute("data-testid")||t.hasAttribute("data-cy"))&&(o+=.05),Math.min(o,1)}function j(t,e,n){const o=t.getAttribute("data-testid");if(o)return y(o);const r=t.id;if(r)return y(r);const a=t.getAttribute("aria-label");if(a)return y(a);const i=t.querySelector("h1, h2, h3, h4, .ant-card-head-title, .el-card__header");if(i&&i.textContent){const c=i.textContent.trim().substring(0,20);if(c)return y(c)}return`${y(e)}${n+1}`}function y(t){return t.replace(/[^a-zA-Z0-9\s]/g," ").split(/\s+/).filter(Boolean).map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join("")}const V={table:[".ant-table",".el-table",".arco-table",'table[role="grid"]',".data-table"],form:[".ant-form",".el-form",".arco-form","form"],button:[".ant-btn",".el-button",".arco-btn",'button:not([class*="close"])'],modal:[".ant-modal",".el-dialog",".arco-modal",'[role="dialog"]'],card:[".ant-card",".el-card",".arco-card"],tabs:[".ant-tabs",".el-tabs",".arco-tabs",'[role="tablist"]'],menu:[],breadcrumb:[".ant-breadcrumb",".el-breadcrumb",".arco-breadcrumb"],pagination:[".ant-pagination",".el-pagination",".arco-pagination"],input:[".ant-input:not(.ant-input-affix-wrapper .ant-input)",".el-input",".arco-input"],select:[".ant-select",".el-select",".arco-select"],checkbox:[".ant-checkbox",".el-checkbox",".arco-checkbox"],radio:[".ant-radio",".el-radio",".arco-radio"],switch:[".ant-switch",".el-switch",".arco-switch"],datepicker:[".ant-picker",".el-date-picker",".arco-picker"],upload:[".ant-upload",".el-upload",".arco-upload"],tree:[".ant-tree:not(.ant-tree-select)",".el-tree",".arco-tree"],transfer:[".ant-transfer",".el-transfer",".arco-transfer"],unknown:[]};function Y(t=document.body){const e=[],n=new Set,o=["table","form","modal","card","tabs","tree","transfer","upload","pagination","breadcrumb","select","datepicker","input","checkbox","radio","switch","button"];for(const r of o){const a=V[r];if(!a||a.length===0)continue;const i=a.join(", "),c=t.querySelectorAll(i);for(const s of c){if(n.has(s)||!S(s))continue;const l=s.parentElement;if(l&&n.has(l))continue;const u=Z(s,r,e.length);e.push(u),n.add(s)}}return e}function Z(t,e,n){return{id:G(),type:e,name:j(t,e,n),config:{},boundingBox:p(t),cssClasses:x(t),sourceSelector:d(t),confidence:W(t,e)}}function K(){const t=R();return Y(t)}const L={headerCell:[".ant-table-cell",".el-table__cell",".arco-table-th","th"],row:[".ant-table-row",".el-table__row",".arco-table-tr","tr"],pagination:[".ant-pagination",".el-pagination",".arco-pagination"]};function v(t,e){for(const n of e){const o=t.querySelector(n);if(o)return o}return null}function X(t,e){for(const n of e){const o=t.querySelectorAll(n);if(o.length>0)return Array.from(o)}return[]}function J(t){const e=[];return X(t,L.headerCell).forEach((o,r)=>{if(o.querySelector(".ant-checkbox, .el-checkbox, .arco-checkbox")||o.querySelector(".ant-table-row-expand-icon, .el-table__expand-icon"))return;const a=f(o);if(!a||a==="操作"||a==="Actions"){(a==="操作"||a==="Actions")&&e.push({key:`action_${r}`,title:a,dataIndex:"actions",render:"actions"});return}const i=o.getAttribute("data-key")||o.getAttribute("data-field")||Q(a),c=o.querySelector(".ant-table-column-sorter, .el-table__sort, .arco-table-sorter")!==null,s=o.classList.contains("ant-table-cell-fix-left")||o.classList.contains("ant-table-cell-fix-right")||o.classList.contains("el-table-fixed-column"),l=window.getComputedStyle(o),u=l.width!=="auto"?parseInt(l.width):void 0;e.push({key:i,title:a,dataIndex:i,width:u,sorter:c,fixed:s?o.classList.contains("ant-table-cell-fix-left")?"left":"right":void 0,ellipsis:o.classList.contains("ant-table-cell-ellipsis")})}),e}function Q(t){const e={序号:"index",编号:"id",ID:"id",名称:"name",标题:"title",描述:"description",创建时间:"createdAt",更新时间:"updatedAt",状态:"status",操作:"actions",类型:"type",金额:"amount",数量:"quantity",用户:"user",姓名:"name",邮箱:"email",手机:"phone",电话:"phone",地址:"address"};return e[t]?e[t]:t.toLowerCase().replace(/[^a-z0-9\s]/g,"").split(/\s+/).map((n,o)=>o===0?n:n.charAt(0).toUpperCase()+n.slice(1)).join("")||`column_${Date.now()}`}function tt(t){const e=v(t,L.pagination);if(!e)return;const n=e.querySelector(".ant-pagination-options-size-changer, .el-pagination__sizes"),o=n==null?void 0:n.textContent,r=o&&parseInt(o)||10,a=e.querySelector(".ant-pagination-options, .el-pagination__sizes")!==null,i=e.querySelector(".ant-pagination-total-text, .el-pagination__total")!==null;return{pageSize:r,showSizeChanger:a,showTotal:i}}function et(t){const e=[],n=v(t,L.row);return n&&n.querySelectorAll('.ant-btn, .el-button, .arco-btn, button, a[class*="link"]').forEach((r,a)=>{const i=f(r);if(!i)return;const c=r.classList.contains("ant-btn-dangerous")||r.classList.contains("el-button--danger")||r.classList.contains("arco-btn-status-danger"),s=r.tagName.toLowerCase()==="a"||r.classList.contains("ant-btn-link")||r.classList.contains("el-button--text");e.push({key:`action_${a}`,label:i,type:s?"link":"button",danger:c})}),e}function nt(t){const e=J(t),n=tt(t.parentElement||t),o=et(t),r=t.classList.contains("ant-table-bordered")||t.querySelector(".ant-table-bordered")!==null,a=v(t,L.row),i=(a==null?void 0:a.getAttribute("data-row-key"))||"id";return{columns:e,pagination:n,rowKey:i,bordered:r,actions:o&&o.length>0?o:void 0}}function ot(t){const e=document.querySelector(t.sourceSelector);if(!e)return t;const n=nt(e);return{...t,config:n}}const T={item:[".ant-form-item",".el-form-item",".arco-form-item"],label:[".ant-form-item-label",".el-form-item__label",".arco-form-item-label","label"],control:[".ant-form-item-control",".el-form-item__content",".arco-form-item-wrapper"],required:[".ant-form-item-required",".el-form-item__label.is-required",".arco-form-item-label-required"]},rt={input:[".ant-input",".el-input",".arco-input",'input[type="text"]','input[type="password"]',"input:not([type])"],textarea:[".ant-input-textarea",".el-textarea",".arco-textarea","textarea"],number:[".ant-input-number",".el-input-number",".arco-input-number",'input[type="number"]'],select:[".ant-select",".el-select",".arco-select","select"],checkbox:[".ant-checkbox",".el-checkbox",".arco-checkbox",'input[type="checkbox"]'],radio:[".ant-radio",".el-radio",".arco-radio",'input[type="radio"]'],switch:[".ant-switch",".el-switch",".arco-switch"],datepicker:[".ant-picker",".el-date-picker",".arco-picker",'input[type="date"]'],upload:[".ant-upload",".el-upload",".arco-upload",'input[type="file"]']};function q(t,e){for(const n of e){const o=t.querySelector(n);if(o)return o}return null}function at(t,e){for(const n of e){const o=t.querySelectorAll(n);if(o.length>0)return Array.from(o)}return[]}function it(t){for(const[e,n]of Object.entries(rt))for(const o of n)if(t.querySelector(o))return e;return"input"}function ct(t){const e={用户名:"username",密码:"password",确认密码:"confirmPassword",邮箱:"email",手机号:"phone",手机:"phone",电话:"phone",姓名:"name",名称:"name",标题:"title",描述:"description",内容:"content",地址:"address",备注:"remark",状态:"status",类型:"type",日期:"date",时间:"time",开始时间:"startTime",结束时间:"endTime",创建时间:"createdAt",更新时间:"updatedAt",金额:"amount",数量:"quantity",价格:"price",排序:"sort",权限:"permissions",角色:"role",部门:"department",公司:"company",图片:"image",头像:"avatar",附件:"attachment"};return e[t]?e[t]:t.toLowerCase().replace(/[^a-z0-9\s]/g,"").split(/\s+/).filter(Boolean).map((n,o)=>o===0?n:n.charAt(0).toUpperCase()+n.slice(1)).join("")||`field_${Date.now()}`}function st(t){const e=t.querySelector("input, textarea, .ant-select-selection-placeholder");if(e)return e.classList.contains("ant-select-selection-placeholder")?f(e):e.placeholder||void 0}function lt(t){const e=t.querySelector("select");if(e)return Array.from(e.options).map(n=>({label:n.text,value:n.value}))}function ut(t){const e=[];return at(t,T.item).forEach(o=>{const r=q(o,T.label),a=r?f(r).replace(/[：:]/g,"").trim():"";if(!a)return;const i=q(o,T.control)||o,c=it(i),s=o.querySelector(T.required.join(", "))!==null||(r==null?void 0:r.classList.contains("ant-form-item-required"))||o.classList.contains("is-required"),l=ct(a),u=st(i),b=c==="select"?lt(i):void 0;let h;const m=o.closest(".ant-col, .el-col");if(m){const g=Array.from(m.classList).find(E=>E.match(/ant-col-\d+|el-col-\d+/));if(g){const E=g.match(/\d+/);h=E?parseInt(E[0]):void 0}}e.push({name:l,label:a,type:c,required:s,placeholder:u,options:b,span:h})}),e}function dt(t){const e=x(t);return e.includes("ant-form-inline")||e.includes("el-form--inline")?"inline":e.includes("ant-form-vertical")||e.includes("el-form--label-top")?"vertical":"horizontal"}function ft(t){const e=t.getAttribute("labelcol")||t.getAttribute("label-width");if(e){const o=e.match(/\d+/);return o?parseInt(o[0]):void 0}const n=t.querySelector(".ant-form-item-label, .el-form-item__label");if(n){const o=n.closest(".ant-col");if(o){const r=Array.from(o.classList).find(a=>a.match(/ant-col-\d+/));if(r){const a=r.match(/\d+/);return a?parseInt(a[0]):void 0}}}}function mt(t){const e=t.querySelectorAll(".ant-btn, .el-button, .arco-btn, button");let n,o;return e.forEach(r=>{const a=f(r);r.classList.contains("ant-btn-primary")||r.classList.contains("el-button--primary")||r.classList.contains("arco-btn-primary")||a.includes("提交")||a.includes("保存")||a.includes("确定")?n=a:(a.includes("取消")||a.includes("重置"))&&(o=a)}),{submitText:n,cancelText:o}}function bt(t){const e=ut(t),n=dt(t),o=ft(t),{submitText:r,cancelText:a}=mt(t),i=o?24-o:void 0;return{fields:e,layout:n,labelCol:o,wrapperCol:i,submitText:r,cancelText:a}}function ht(t){const e=document.querySelector(t.sourceSelector);if(!e)return t;const n=bt(e);return{...t,config:n}}function pt(t){const e=window.getComputedStyle(t).position;return e==="fixed"||e==="sticky"}const gt={headerSelectors:[".ant-layout-header",".el-header",".el-menu--horizontal",".arco-layout-header","header",'[role="banner"]',".header",".top-bar",".navbar",".nav-header","#header"],sidebarSelectors:[".ant-layout-sider",".ant-menu:not(.ant-menu-horizontal)",".el-aside",".el-menu:not(.el-menu--horizontal)",".arco-layout-sider","aside",'[role="navigation"]:not(header *)',".sidebar",".side-menu",".side-nav",".left-menu","#sidebar"],contentSelectors:[".ant-layout-content",".el-main",".arco-layout-content","main",'[role="main"]',".content",".main-content",".page-content",".container:not(.ant-layout):not(.el-container)","#content","#main"],footerSelectors:[".ant-layout-footer",".el-footer",".arco-layout-footer","footer",'[role="contentinfo"]',".footer","#footer"],breadcrumbSelectors:[".ant-breadcrumb",".el-breadcrumb",".arco-breadcrumb",'[aria-label="breadcrumb"]',".breadcrumb",'nav[aria-label*="breadcrumb"]']};function A(t){for(const e of t){const n=M(e);if(n.length>0)return n[0]}return null}function yt(t){const e=A(t.headerSelectors);if(!e)return null;const n=p(e);return n.y>200||n.width<window.innerWidth*.5?null:{type:"header",selector:d(e),boundingBox:n}}function wt(t){const e=A(t.sidebarSelectors);if(!e)return null;const n=p(e),o=n.width<window.innerWidth*.4,r=n.height>window.innerHeight*.5;return!o||!r?null:{type:"sidebar",selector:d(e),boundingBox:n}}function St(t){const e=A(t.contentSelectors);return e?{type:"content",selector:d(e),boundingBox:p(e)}:null}function At(t){const e=A(t.footerSelectors);if(!e)return null;const n=p(e),o=window.innerHeight;return n.y<o*.5&&!pt(e)?null:{type:"footer",selector:d(e),boundingBox:n}}function Et(t){const e=A(t.breadcrumbSelectors);return e?{type:"breadcrumb",selector:d(e),boundingBox:p(e)}:null}function Tt(t){const e={...gt,...t},n=[],o=yt(e),r=wt(e),a=St(e),i=At(e),c=Et(e);o&&n.push(o),r&&n.push(r),a&&n.push(a),i&&n.push(i),c&&n.push(c);let s,l;r&&(l=r.boundingBox.width,s=r.boundingBox.x<window.innerWidth/2?"left":"right");const u=o==null?void 0:o.boundingBox.height;return{hasHeader:o!==null,hasSidebar:r!==null,hasFooter:i!==null,sidebarPosition:s,sidebarWidth:l,headerHeight:u,regions:n}}const C={antdSubMenu:".ant-menu-submenu",elementSubMenu:".el-submenu"},Ct={dashboard:[/dashboard/i,/home/i,/index/i,/overview/i],user:[/user/i,/person/i,/account/i,/profile/i,/member/i],setting:[/setting/i,/config/i,/preference/i,/gear/i,/cog/i],table:[/table/i,/list/i,/grid/i,/data/i],form:[/form/i,/edit/i,/write/i,/input/i],chart:[/chart/i,/graph/i,/statistic/i,/analytics/i],file:[/file/i,/document/i,/folder/i,/attachment/i],message:[/message/i,/mail/i,/notification/i,/bell/i,/comment/i],shop:[/shop/i,/cart/i,/order/i,/product/i,/goods/i],money:[/money/i,/finance/i,/payment/i,/wallet/i,/dollar/i],team:[/team/i,/group/i,/organization/i,/department/i],calendar:[/calendar/i,/date/i,/schedule/i,/event/i],search:[/search/i,/find/i,/query/i],lock:[/lock/i,/security/i,/permission/i,/auth/i],api:[/api/i,/interface/i,/endpoint/i],database:[/database/i,/db/i,/storage/i],cloud:[/cloud/i,/upload/i,/download/i],tool:[/tool/i,/utility/i,/wrench/i]};function Lt(t){const e=t.querySelector('[class*="icon"], i, svg, .anticon');if(!e)return;const n=e.className||"",o=typeof n=="string"?n:"";for(const[s,l]of Object.entries(Ct))for(const u of l)if(u.test(o))return s;const r=o.match(/anticon-(\w+)/);if(r)return r[1];const a=o.match(/fa-(\w+)/);if(a)return a[1];const i=o.match(/el-icon-(\w+)/);if(i)return i[1];const c=o.match(/icon-(\w+)/);if(c)return c[1]}function xt(t){if(t.tagName==="A")return t.getAttribute("href")||void 0;const e=t.querySelector("a[href]");if(e)return e.getAttribute("href")||void 0;const n=t.getAttribute("data-path")||t.getAttribute("data-route")||t.getAttribute("data-href");if(n)return n;const r=(t.getAttribute("onclick")||"").match(/['"]([/\w-]+)['"]/);if(r)return r[1]}function vt(t){var o,r;const e=t.querySelector('.ant-menu-title-content, .menu-title, .nav-text, [class*="title"], span:not([class*="icon"])');if(e)return((o=e.textContent)==null?void 0:o.trim())||"";const n=t.cloneNode(!0);return n.querySelectorAll('[class*="icon"], i, svg, .anticon').forEach(a=>a.remove()),n.querySelectorAll('[class*="badge"], [class*="count"], sup').forEach(a=>a.remove()),((r=n.textContent)==null?void 0:r.trim())||""}function kt(t){if(t.matches(C.antdSubMenu)||t.matches(C.elementSubMenu))return!0;const e=t.className||"";if(/submenu|sub-menu|has-child|has-submenu|expandable/i.test(e))return!0;const n=t.querySelector(":scope > ul, :scope > ol, :scope > div > ul");return!!(n&&n.children.length>0||t.querySelector(".ant-menu-sub, .ant-menu-inline")||t.querySelector('[class*="expand"], [class*="arrow"], [class*="caret"], .ant-menu-submenu-arrow'))}function _t(t){const e=[".ant-menu-sub",".ant-menu-inline",".el-menu",'[class*="submenu-content"]','[class*="sub-menu"]',":scope > ul",":scope > ol",":scope > div > ul"];for(const n of e){const o=t.querySelector(n);if(o&&o.children.length>0)return o}return null}function N(t){const e=t.querySelectorAll(":scope > .ant-menu-item, :scope > .ant-menu-submenu, :scope > .ant-menu-item-group");if(e.length>0)return Array.from(e);const n=t.querySelectorAll(":scope > .el-menu-item, :scope > .el-submenu");if(n.length>0)return Array.from(n);const o=t.querySelectorAll(":scope > li");return o.length>0?Array.from(o):Array.from(t.children).filter(r=>{var l;const a=r.tagName.toLowerCase();if(a==="style"||a==="script"||a==="svg")return!1;const i=r.className||"",c=(l=r.textContent)==null?void 0:l.trim(),s=/menu|nav|item/i.test(i);return c&&(a==="li"||a==="a"||s)})}function D(t,e=0,n){let o=t;if(t.matches(C.antdSubMenu)||t.matches(C.elementSubMenu)){const u=t.querySelector('.ant-menu-submenu-title, .el-submenu__title, [class*="submenu-title"]');u&&(o=u)}const r=vt(o);if(!r)return null;const a=`menu-${Date.now()}-${Math.random().toString(36).substring(2,7)}`,i=xt(t),c=Lt(o),s=t.classList.contains("ant-menu-item-selected")||t.classList.contains("ant-menu-submenu-selected")||t.classList.contains("ant-menu-submenu-open")||t.classList.contains("active")||t.classList.contains("is-active")||t.getAttribute("aria-selected")==="true",l={id:a,title:r,path:i,icon:c,level:e,parentId:n,isActive:s,sourceSelector:I(t)};if(kt(t)){const u=_t(t);if(u){const b=N(u),h=[];b.forEach(m=>{if(m.classList.contains("ant-menu-item-divider")||m.classList.contains("divider")||m.classList.contains("separator"))return;const g=D(m,e+1,a);g&&h.push(g)}),h.length>0&&(l.children=h)}}return l}function qt(){const t=document.querySelector(".ant-layout-sider .ant-menu");if(t&&t.children.length>0)return console.log("[Menu Analyzer] Found sider menu"),t;const e=['[class*="sidebar"] .ant-menu','[class*="sider"] .ant-menu',"aside .ant-menu",".ant-menu-inline",".ant-menu-vertical"];for(const c of e){const s=document.querySelector(c);if(s&&s.children.length>2)return console.log("[Menu Analyzer] Found menu with selector:",c),s}const n=document.querySelectorAll(".ant-menu:not(.ant-menu-sub):not(.ant-menu-submenu-popup)");let o=null,r=0;if(n.forEach(c=>{const s=c.querySelectorAll(".ant-menu-item, .ant-menu-submenu").length;s>r&&(r=s,o=c)}),o&&r>2)return console.log("[Menu Analyzer] Found best ant-menu with",r,"items"),o;const a=document.querySelector(".el-menu:not(.el-menu--popup)");if(a&&a.children.length>0)return console.log("[Menu Analyzer] Found Element UI menu"),a;const i=document.querySelector('[class*="sidebar"], [class*="sider"], aside');if(i){const c=i.querySelector('ul, nav, [class*="menu"]');if(c&&c.children.length>0)return console.log("[Menu Analyzer] Found menu in sidebar"),c}return null}function Mt(t){return window.getComputedStyle(t).flexDirection==="row"||t.classList.contains("ant-menu-horizontal")||t.classList.contains("el-menu--horizontal")?"horizontal":t.classList.contains("ant-menu-inline")||t.classList.contains("ant-menu-vertical")||t.closest(".ant-layout-sider")?"sidebar":"inline"}function It(){const t=qt();if(!t)return console.log("[Menu Analyzer] No menu container found"),null;console.log("[Menu Analyzer] Analyzing menu container:",t.className);const e=Mt(t),n=[],o=N(t);if(console.log("[Menu Analyzer] Found top-level elements:",o.length),o.forEach((i,c)=>{var u,b;if(i.classList.contains("ant-menu-item-divider")||i.classList.contains("divider"))return;const s=(u=i.textContent)==null?void 0:u.trim().substring(0,30);console.log(`[Menu Analyzer] Processing item ${c}: "${s}"`,i.className);const l=D(i,0);l&&(n.push(l),console.log(`[Menu Analyzer] Parsed: "${l.title}", children: ${((b=l.children)==null?void 0:b.length)||0}`))}),n.length===0)return console.log("[Menu Analyzer] No menu items found"),null;const r={id:`menu-${Date.now()}`,items:n,type:e,sourceSelector:I(t),analyzedAt:Date.now()},a=z(n);return console.log("[Menu Analyzer] Menu analysis complete:",{type:e,topLevelCount:n.length,totalItems:a}),r}function z(t){let e=t.length;for(const n of t)n.children&&(e+=z(n.children));return e}const U={timeout:3e4,stabilityDelay:500,readySelector:"",checkInterval:100};function k(t={}){const e={...U,...t};return new Promise((n,o)=>{let r=Date.now(),a,i;const c=new MutationObserver(()=>{r=Date.now()});c.observe(document.body,{childList:!0,subtree:!0,attributes:!0,characterData:!0}),a=setInterval(()=>{Date.now()-r>=e.stabilityDelay&&(s(),n())},e.checkInterval),i=setTimeout(()=>{s(),o(new Error(`DOM stability timeout after ${e.timeout}ms`))},e.timeout);function s(){c.disconnect(),clearInterval(a),clearTimeout(i)}})}function Nt(t,e={}){const n={...U,...e};return new Promise((o,r)=>{let a,i;a=setInterval(()=>{const s=window.location.href;s!==t&&(c(),o(s))},n.checkInterval),i=setTimeout(()=>{c(),r(new Error(`URL did not change from "${t}" after ${n.timeout}ms`))},n.timeout);function c(){clearInterval(a),clearTimeout(i)}})}const Dt={timeout:3e4,clickDelay:500,waitForUrlChange:!0,scrollIntoView:!0};function zt(t){var e;if(t.sourceSelector){const n=document.querySelector(t.sourceSelector);if(n)return n}if(t.path){const n=document.querySelector(`a[href="${t.path}"]`);if(n)return n;const o=document.querySelector(`a[href*="${t.path}"]`);if(o)return o}if(t.title){const n=document.querySelectorAll('.ant-menu-item, .ant-menu-submenu-title, [class*="menu-item"], li a');for(const o of n)if((e=o.textContent)!=null&&e.trim().includes(t.title))return o}return null}function Ut(t){const e=t.getBoundingClientRect();if(e.width===0||e.height===0||e.top<0||e.left<0)return!1;e.bottom>window.innerHeight||e.right>window.innerWidth;const n=window.getComputedStyle(t);return!(n.display==="none"||n.visibility==="hidden"||parseFloat(n.opacity)===0)}async function Ot(t){let e=t.parentElement;const n=[];for(;e;){if(e.classList.contains("ant-menu-submenu")&&!e.classList.contains("ant-menu-submenu-open")){const r=e.querySelector(".ant-menu-submenu-title");r&&n.unshift(r)}if(e.classList.contains("el-submenu")&&!e.classList.contains("is-opened")){const r=e.querySelector(".el-submenu__title");r&&n.unshift(r)}e=e.parentElement}for(const o of n)o.click(),await new Promise(r=>setTimeout(r,300))}function Pt(t){if(t instanceof HTMLElement){t.click();return}const e=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});t.dispatchEvent(e)}async function $t(t,e={}){const n={...Dt,...e},o=Date.now(),r=window.location.href;try{const a=zt(t);if(!a)return{success:!1,url:r,error:`Could not find clickable element for menu item: ${t.title}`,duration:Date.now()-o};if(await Ot(a),n.scrollIntoView&&(a.scrollIntoView({behavior:"smooth",block:"center"}),await new Promise(i=>setTimeout(i,200))),!Ut(a))return{success:!1,url:r,error:`Element is not clickable: ${t.title}`,duration:Date.now()-o};if(Pt(a),n.waitForUrlChange&&t.path)try{await Promise.race([Nt(r,{timeout:n.timeout}),new Promise((i,c)=>setTimeout(()=>c(new Error("Navigation timeout")),n.timeout))])}catch{console.log("[Navigation] URL did not change, checking DOM stability")}return await k({stabilityDelay:300,timeout:5e3}),n.clickDelay>0&&await new Promise(i=>setTimeout(i,n.clickDelay)),{success:!0,url:window.location.href,duration:Date.now()-o}}catch(a){return{success:!1,url:window.location.href,error:a instanceof Error?a.message:"Unknown navigation error",duration:Date.now()-o}}}const w="data-admin-clone-interaction-id",Ft=8,Rt=["删","刪","删除","刪除","remove","移除","删除","解散","终止","停止","stop","禁用","disable","关闭","關閉","close","退出","log out","logout","作废","废弃","废除"],_=new Map;function O(){document.querySelectorAll(`[${w}]`).forEach(t=>t.removeAttribute(w)),_.clear()}function Bt(t){const e=t.toLowerCase();return Rt.some(n=>e.includes(n.toLowerCase()))}function P(t,e,n){var s;if(!S(t))return null;const o=((s=n.label)==null?void 0:s.trim())||f(t)||"未命名交互";if(e==="button"&&Bt(o))return null;const r=`interaction-${Date.now()}-${Math.random().toString(36).slice(2,8)}`;t.setAttribute(w,r);const a=d(t),i=`[${w}="${r}"]`,c={id:r,type:e,label:o,group:n.group,groupLabel:n.groupLabel,description:n.description,selector:i,order:n.order,source:n.source,attributes:n.attributes};return _.set(r,{...c,originalSelector:a}),c}function Ht(){const t=[".ant-tabs",".ant-pro-card-tabs",".el-tabs",".arco-tabs",'[role="tablist"]'],e=[];return t.forEach(n=>{document.querySelectorAll(n).forEach(o=>{S(o)&&!e.includes(o)&&e.push(o)})}),e}function Gt(t,e){const n=[];let o=e;for(const r of Ht()){const a=r.querySelectorAll('.ant-tabs-tab, .ant-tabs-tab-btn, .el-tabs__item, .arco-tabs-item, [role="tab"]'),i=d(r),c=r.getAttribute("aria-label")||"Tabs";if(a.forEach(s=>{if(e+n.length>=t||!s||!S(s))return;const l=f(s)||"Tab";if(l.length===0)return;const u=P(s,"tab",{label:l,group:i,groupLabel:c,description:"自动切换标签页视图",order:o++,source:"tabs"});u&&n.push(u)}),e+n.length>=t)break}return n}const Wt=["[data-admin-clone-trigger]","[data-auto-trigger]","[data-clone-trigger]"],jt=[".ant-segmented-item",".ant-radio-button-wrapper",".ant-btn-group > .ant-btn",".el-radio-button"];function Vt(t){if(!(t instanceof HTMLElement)||!t.dataset)return;const e=Object.entries(t.dataset).filter(([,n])=>n!==void 0);if(e.length!==0)return Object.fromEntries(e)}function Yt(t,e){const n=[];let o=e;const r=(a,i)=>{if(e+n.length>=t)return;const c=P(a,"button",{label:f(a)||"Button",group:void 0,groupLabel:void 0,description:"自动触发按钮/开关后的页面",order:o++,source:i,attributes:Vt(a)});c&&n.push(c)};return Wt.forEach(a=>{document.querySelectorAll(a).forEach(i=>{e+n.length>=t||r(i,"annotation")})}),jt.forEach(a=>{document.querySelectorAll(a).forEach(i=>{e+n.length>=t||r(i,"toggle")})}),n}function Zt(t=Ft){O();const e=[],n=Gt(t,0);if(e.push(...n),e.length<t){const o=Yt(t,e.length);e.push(...o)}return e}function Kt(t){const e=_.get(t);if(!e)return null;const n=document.querySelector(e.selector);if(n)return n;const o=document.querySelector(e.originalSelector);return o?(o.setAttribute(w,t),o):null}async function Xt(t){let e=Kt(t);if(!e)return{success:!1,targetId:t,error:"无法找到交互元素"};try{return e instanceof HTMLElement&&e.scrollIntoView({behavior:"smooth",block:"center"}),await new Promise(n=>setTimeout(n,150)),e.click(),await k({stabilityDelay:400,timeout:6e3}),{success:!0,targetId:t}}catch(n){return{success:!1,targetId:t,error:n instanceof Error?n.message:"交互触发失败"}}}function Jt(){O()}console.log("[Admin Clone] Content script loaded");function Qt(){return`page-${Date.now()}-${Math.random().toString(36).substring(2,9)}`}function te(t){return t.map(e=>{switch(e.type){case"table":return ot(e);case"form":return ht(e);default:return e}})}async function ee(t,e){const n=Date.now(),o=H(),r=Tt();let a=K();a=te(a);const i={id:Qt(),sessionId:t||"",url:o.url,title:o.title,path:o.path,status:"completed",layout:r,components:a,interactionContext:e,analyzedAt:Date.now()},c=Date.now()-n;return console.log(`[Admin Clone] Page analysis completed in ${c}ms`,{url:i.url,componentCount:a.length,layout:{hasHeader:r.hasHeader,hasSidebar:r.hasSidebar}}),i}chrome.runtime.onMessage.addListener((t,e,n)=>{switch(console.log("[Admin Clone] Content script received message:",t),t.type){case"ANALYZE_PAGE":{const o=t;return ee(o.sessionId,o.interactionContext).then(r=>{const a={type:"ANALYSIS_RESULT",result:{success:!0,page:r,duration:r.analyzedAt?Date.now()-r.analyzedAt:0}};n(a)}).catch(r=>{console.error("[Admin Clone] Analysis failed:",r);const a={type:"ANALYSIS_RESULT",result:{success:!1,error:r.message||"Unknown error during analysis"}};n(a)}),!0}case"GET_PAGE_INFO":n({type:"PAGE_INFO",data:{url:window.location.href,title:document.title,readyState:document.readyState}});break;case"ANALYZE_MENU":{try{const o=It();n(o?{type:"MENU_RESULT",success:!0,menu:o}:{type:"MENU_RESULT",success:!1,error:"未找到菜单结构，请确保页面包含侧边栏或导航菜单"})}catch(o){console.error("[Admin Clone] Menu analysis failed:",o),n({type:"MENU_RESULT",success:!1,error:o instanceof Error?o.message:"菜单分析失败"})}break}case"TRAVERSE_NAVIGATE":{const{menuItem:o}=t;return $t(o,{timeout:15e3,clickDelay:300}).then(async r=>{r.success&&(await k({stabilityDelay:500,timeout:5e3}),Jt()),n(r)}).catch(r=>{n({success:!1,url:window.location.href,error:r instanceof Error?r.message:"Navigation failed",duration:0})}),!0}case"COLLECT_INTERACTIONS":{try{const o=typeof t.limit=="number"?t.limit:void 0,r=Zt(o);n({type:"INTERACTION_TARGETS",result:{success:!0,targets:r}})}catch(o){n({type:"INTERACTION_TARGETS",result:{success:!1,targets:[],error:o instanceof Error?o.message:"collect interactions failed"}})}break}case"RUN_INTERACTION":return Xt(t.targetId).then(o=>{n({type:"INTERACTION_RUN_RESULT",result:o})}).catch(o=>{n({type:"INTERACTION_RUN_RESULT",result:{success:!1,targetId:t.targetId,error:o instanceof Error?o.message:"interaction failed"}})}),!0;default:console.warn("[Admin Clone] Unknown message type:",t.type)}return!0});
//# sourceMappingURL=index.ts-BSDF9_CD.js.map
